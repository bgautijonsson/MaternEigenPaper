<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
  <front>
    <article-meta>
      <title-group>
        <article-title>Efficient Gaussian Copula Density Computation for
Large-Scale Spatial Data: A MatÃ©rn-like GMRF Approach with Circulant and
Folded Circulant Approximations</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>JÃ³nsson</surname>
            <given-names>BrynjÃ³lfur Gauti GuÃ°rÃºnar</given-names>
          </name>
          <string-name>BrynjÃ³lfur Gauti GuÃ°rÃºnar JÃ³nsson</string-name>
          <email>brynjolfur@hi.is</email>
          <xref ref-type="aff" rid="aff-1">a</xref>
        </contrib>
      </contrib-group>
      <aff id="aff-1">
        <institution-wrap>
          <institution>University of Iceland</institution>
        </institution-wrap>
      </aff>
      <history/>
    </article-meta>
  </front>
  <body>
    <sec id="introduction">
      <title>Introduction</title>
      <sec id="problem-formulation">
        <title>Problem Formulation</title>
        <p>Consider a spatial field on a regular
    <inline-formula><alternatives><tex-math><![CDATA[n_1 \times n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    grid. Our objective is to compute the Gaussian copula density
    efficiently for this field. This computation involves:</p>
        <list list-type="order">
          <list-item>
            <p>Specifying an <inline-formula><alternatives><tex-math><![CDATA[n_1 n_2 \times n_1 n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
        precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
        that represents the spatial dependence structure.</p>
          </list-item>
          <list-item>
            <p>Ensuring the implied covariance matrix
        <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma} = \mathbf{Q}^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
        has unit diagonal elements.</p>
          </list-item>
          <list-item>
            <p>Computing the log determinant, <inline-formula><alternatives><tex-math><![CDATA[\log |\mathbf Q|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>ğ</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
        and the quadratic form <inline-formula><alternatives><tex-math><![CDATA[z^T \mathbf Q z]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
        where <inline-formula><alternatives><tex-math><![CDATA[z_i = \Phi^{-1}(f_i(y_i))]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
          </list-item>
        </list>
      </sec>
      <sec id="review">
        <title>Review</title>
        <p>Gaussian Markov Random Fields (GMRFs) and copulas are two
    powerful statistical tools, each offering unique strengths in
    modeling complex data structures. GMRFs excel in capturing spatial
    and temporal dependencies, particularly in fields such as
    environmental science, epidemiology, and image analysis. Their
    ability to represent local dependencies through sparse precision
    matrices makes them computationally attractive for high-dimensional
    problems. Copulas, on the other hand, provide a flexible framework
    for modeling multivariate dependencies, allowing separate
    specification of marginal distributions and their joint
    behavior.</p>
        <p>The Gaussian copula, in particular, has gained popularity due to
    its interpretability and connection to the multivariate normal
    distribution. However, combining GMRFs with copulas has historically
    been computationally challenging, limiting their joint application
    to smaller datasets or simpler models.</p>
        <p>Let <inline-formula><alternatives><tex-math><![CDATA[\mathbf{X} = (X_1, X_2, \ldots, X_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ—</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    be a multivariate random vector with marginal distribution functions
    <inline-formula><alternatives><tex-math><![CDATA[F_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    for <inline-formula><alternatives><tex-math><![CDATA[i = 1, 2, \ldots, n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
    The joint distribution function of <inline-formula><alternatives><tex-math><![CDATA[\mathbf{X}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ—</mml:mi></mml:math></alternatives></inline-formula>
    can be written as:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    F_{\mathbf{X}}(\mathbf{x}) = C(F_1(x_1), F_2(x_2), \ldots, F_n(x_n)),
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>F</mml:mi>
                    <mml:mi>ğ—</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>ğ±</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:msub>
                      <mml:mi>F</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>F</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mi>â€¦</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>F</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is the Gaussian copula defined by the GMRF precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>.
    The Gaussian copula <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is given by:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    C(u_1, u_2, \ldots, u_n) = \Phi_\mathbf{Q}(\Phi^{-1}(u_1), \Phi^{-1}(u_2), \ldots, \Phi^{-1}(u_n)),
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:msub>
                      <mml:mi>u</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>u</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mi>â€¦</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>u</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>Î¦</mml:mi>
                    <mml:mi>ğ</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:msup>
                      <mml:mi>Î¦</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>Î¦</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mi>â€¦</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>Î¦</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\Phi_\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Î¦</mml:mi><mml:mi>ğ</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the joint cumulative distribution function of a multivariate
    normal distribution with mean vector <inline-formula><alternatives><tex-math><![CDATA[\mathbf{0}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mn>ğŸ</mml:mn></mml:math></alternatives></inline-formula>
    and precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Phi^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    is the inverse of the standard normal cumulative distribution
    function.</p>
        <p>A critical requirement for the precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    governing the GMRF copula <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is that <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma} = \mathbf{Q}^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
    should have a unit diagonal, i.e.Â the marginal variance is equal to
    one everywhere.. This ensures it operates on the same scale as the
    transformed data, <inline-formula><alternatives><tex-math><![CDATA[\Phi^{-1}(u_i)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
    However, this can be challenging as GMRFs are typically defined in
    terms of precision matrices that often imply non-unit marginal
    variances.</p>
        <p>This paper presents a novel algorithm that bridges the gap
    between GMRFs and copulas, allowing for fast and efficient
    computation of Gaussian copula densities using GMRF precision
    structures. Our method focuses on creating a MatÃ©rn-like precision
    matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    with unit marginal variance and efficiently computing the
    multivariate Gaussian copula density of
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Z} = \Phi^{-1}(\mathbf{u})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ™</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    where <inline-formula><alternatives><tex-math><![CDATA[u_i \sim \text{Uniform}(0, 1)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">Uniform</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[i = 1, \dots, n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        <p>The key innovation lies in leveraging the special structure of
    the precision matrix:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \mathbf{Q} = \mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2},
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>ğ</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>ğ</mml:mi>
                    <mml:msub>
                      <mml:mi>Ï</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>âŠ—</mml:mo>
                  <mml:msub>
                    <mml:mi>ğˆ</mml:mi>
                    <mml:msub>
                      <mml:mi>ğ§</mml:mi>
                      <mml:mn>ğŸ</mml:mn>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>ğˆ</mml:mi>
                    <mml:msub>
                      <mml:mi>ğ§</mml:mi>
                      <mml:mn>ğŸ</mml:mn>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>âŠ—</mml:mo>
                  <mml:msub>
                    <mml:mi>ğ</mml:mi>
                    <mml:msub>
                      <mml:mi>Ï</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the precision matrix of a standardized one-dimensional AR(1)
    process with correlation <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
    denotes the Kronecker product. By employing efficient
    eigendecomposition techniques, our method avoids explicit formation
    and inversion of the large precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    making it particularly suitable for high-dimensional spatial data.
    In addition to the exact method, we show how the precision matrix
    can be approximated by a folded circulant matrix wich gives a large
    speed-up while preserving suitable boundary conditions.</p>
      </sec>
    </sec>
    <sec id="methods">
      <title>Methods</title>
      <sec id="gaussian-copula-density-computation">
        <title>Gaussian Copula Density Computation</title>
        <p>The Gaussian copula density for a random vector
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{U} = (U_1, ..., U_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ”</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    with <inline-formula><alternatives><tex-math><![CDATA[U_i \sim \text{Uniform}(0,1)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">Uniform</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is given by:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    c(\mathbf{u}) = |\mathbf{Q}|^{1/2} \exp\left(-\frac{1}{2}\mathbf{z}^T(\mathbf{Q} - \mathbf{I})\mathbf{z}\right)
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>ğ®</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">|</mml:mo>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo stretchy="true" form="postfix">|</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mi>/</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>exp</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>âˆ’</mml:mi>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo>âˆ’</mml:mo>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z} = (z_1, ..., z_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    with <inline-formula><alternatives><tex-math><![CDATA[z_i = \Phi^{-1}(u_i)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    is the precision matrix, and <inline-formula><alternatives><tex-math><![CDATA[\mathbf{I}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğˆ</mml:mi></mml:math></alternatives></inline-formula>
    is the identity matrix.</p>
        <p>The log-density can be expressed as:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \log c(\mathbf{u}) = \frac{1}{2}\log|\mathbf{Q}| - \frac{1}{2}\mathbf{z}^T\mathbf{Q}\mathbf{z} + \frac{1}{2}\mathbf{z}^T\mathbf{z}
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mo>log</mml:mo>
                  <mml:mi>c</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>ğ®</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:mo>log</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">|</mml:mo>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo stretchy="true" form="postfix">|</mml:mo>
                  </mml:mrow>
                  <mml:mo>âˆ’</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:msup>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                  <mml:mi>ğ</mml:mi>
                  <mml:mi>ğ³</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:msup>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                  <mml:mi>ğ³</mml:mi>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>Our goal is to efficiently compute this log-density for large
    spatial fields.</p>
      </sec>
      <sec id="precision-matrix-structure">
        <title>Precision Matrix Structure</title>
        <p>We define the precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    as:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \mathbf{Q} = (\mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2})^{(\nu + 1)}, \quad \nu \in \{0, 1, 2\}
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>ğ</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:msub>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ§</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ§</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:msub>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>Î½</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="1.0em"/>
                  <mml:mi>Î½</mml:mi>
                  <mml:mo>âˆˆ</mml:mo>
                  <mml:mo stretchy="false" form="prefix">{</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false" form="postfix">}</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the precision matrix of a one-dimensional AR(1) process with
    correlation <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \mathbf{Q}_\rho = \frac{1}{1-\rho^2}
    \begin{bmatrix}
    1 & -\rho & 0 & \cdots & 0 \\
    -\rho & 1+\rho^2 & -\rho & \cdots & 0 \\
    0 & -\rho & 1+\rho^2 & \cdots & 0 \\
    \vdots & \vdots & \vdots & \ddots & \vdots \\
    0 & 0 & 0 & \cdots & 1
    \end{bmatrix}
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>ğ</mml:mi>
                    <mml:mi>Ï</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>âˆ’</mml:mo>
                      <mml:msup>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">[</mml:mo>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mi>Ï</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mi>Ï</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>1</mml:mn>
                          <mml:mo>+</mml:mo>
                          <mml:msup>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mi>Ï</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mi>Ï</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>1</mml:mn>
                          <mml:mo>+</mml:mo>
                          <mml:msup>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mo>â‹±</mml:mo>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>0</mml:mn>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mn>1</mml:mn>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mo stretchy="true" form="postfix">]</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>The matrix, <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    is then scaled so that its inverse, <inline-formula><alternatives><tex-math><![CDATA[\mathbf \Sigma = \mathbf Q^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
    is a correlation matrix, i.e.Â <inline-formula><alternatives><tex-math><![CDATA[\mathbf \Sigma_{ii} = 1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğšº</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
      </sec>
      <sec id="computation-process">
        <title>Computation Process</title>
        <sec id="step-1-eigendecomposition-of-mathbfq_rho">
          <title>Step 1: Eigendecomposition of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula></title>
          <p>We first compute the eigendecomposition of both
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>$:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q}_{\rho} = \mathbf{V_{\rho}}\mathbf{\Lambda_\rho}\mathbf{V_\rho}^T
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:mi>Ï</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ•</mml:mi>
                      <mml:mi>ğ›’</mml:mi>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi>ğš²</mml:mi>
                      <mml:mi>ğ›’</mml:mi>
                    </mml:msub>
                    <mml:msup>
                      <mml:msub>
                        <mml:mi>ğ•</mml:mi>
                        <mml:mi>ğ›’</mml:mi>
                      </mml:msub>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{V_\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ•</mml:mi><mml:mi>ğ›’</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is the matrix of eigenvectors and <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Lambda_\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğš²</mml:mi><mml:mi>ğ›’</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is the diagonal matrix of eigenvalues. Then, because of how
      <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
      is defined, its eigendecomposition is:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q} = (\mathbf{V_{\rho_1}} \otimes \mathbf{V_{\rho_2}})(\mathbf{\Lambda_{\rho_1}} \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{\Lambda_{\rho_2}})^{(\nu + 1)}(\mathbf{V_{\rho_1}} \otimes \mathbf{V_{\rho_2}})^T.
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ•</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ›’</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ•</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ›’</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>ğš²</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ›’</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğš²</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ›’</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>Î½</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ•</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ›’</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ•</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ›’</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi>.</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>We donâ€™t work with the full eigendecomposition, but rather
      utilize the fact that the eigenvalues of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      are <inline-formula><alternatives><tex-math><![CDATA[\left\{\lambda_{\rho_1}\right\}_i + \left\{\lambda_{\rho_2}\right\}_j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      and their corresponding eigenvectors are
      <inline-formula><alternatives><tex-math><![CDATA[\left\{\mathbf{v}_{\rho_1}\right\}_i \otimes \left\{\mathbf{v}_{\rho_2}\right\}_j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      to iterate over each value and vector pair to compute the density
      without forming the larger matrix.</p>
        </sec>
        <sec id="step-2-computation-of-marginal-standard-deviations">
          <title>Step 2: Computation of Marginal Standard Deviations</title>
          <p>In order to scale <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      so that its inverse is a correlation matrix, we first calculate
      <inline-formula><alternatives><tex-math><![CDATA[\sigma_i = \sqrt\Sigma_{ii}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:msqrt><mml:mi>Î£</mml:mi></mml:msqrt><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[i = 1, \dots, n_1n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
      We then use these marginal standard deviations to scale the
      eigenvectors and values. The inverse of
      <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
      is given by:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \boldsymbol \Sigma = \mathbf Q^{-1} = (VAV^T)^{-1} = VA^{-1}V
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğšº</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msup>
                      <mml:mi>ğ</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>=</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>V</mml:mi>
                        <mml:mi>A</mml:mi>
                        <mml:msup>
                          <mml:mi>V</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>=</mml:mo>
                    <mml:mi>V</mml:mi>
                    <mml:msup>
                      <mml:mi>A</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>V</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>The diagonal elements, <inline-formula><alternatives><tex-math><![CDATA[\boldsymbol \Sigma_{ii}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğšº</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      are given by:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \Sigma_{ii} = \sum_{k=1}^{n} v_{ik} \frac{1}{\lambda_k} (v^T)_{ki} = \sum_{k=1}^{n} v_{ik} \frac{1}{\lambda_k} v_{ik} = \sum_{k=1}^{n} v_{ik}^2 \frac{1}{\lambda_k}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>Î£</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:munderover>
                      <mml:mo>âˆ‘</mml:mo>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:munderover>
                    <mml:msub>
                      <mml:mi>v</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:msub>
                        <mml:mi>Î»</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                    </mml:mfrac>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msup>
                          <mml:mi>v</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:munderover>
                      <mml:mo>âˆ‘</mml:mo>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:munderover>
                    <mml:msub>
                      <mml:mi>v</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:msub>
                        <mml:mi>Î»</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                    </mml:mfrac>
                    <mml:msub>
                      <mml:mi>v</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:munderover>
                      <mml:mo>âˆ‘</mml:mo>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:munderover>
                    <mml:msubsup>
                      <mml:mi>v</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:msub>
                        <mml:mi>Î»</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>This means that the <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>â€™th
      marginal variance, <inline-formula><alternatives><tex-math><![CDATA[\sigma_i^2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>,
      is a weighted sum of the reciprocals of the eigenvalues of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      where the weights are the squares of the
      <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>â€™th
      value in each eigenvector. This means that we can calculate the
      marginal standard deviations by iterating over the eigenvalues and
      -vectors of <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      and cumulating their values according to the formula above, then
      taking the element-wise square roots.</p>
        </sec>
        <sec id="step-3-scaling-the-eigendecomposition">
          <title>Step 3: Scaling the Eigendecomposition</title>
          <p>To scale the eigendecomposition of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      using the marginal standard deviations, we define a diagonal
      matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{D}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğƒ</mml:mi></mml:math></alternatives></inline-formula>,
      where <inline-formula><alternatives><tex-math><![CDATA[D_{ii} = \sigma_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      and scale the precision matrix as:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \begin{aligned}
      \mathbf{\widetilde  Q} &= \mathbf{D}\mathbf{Q}^{\nu+1}\mathbf{D} \\
      &= \mathbf{D}\mathbf{V}\mathbf{\Lambda}^{\nu+1}\mathbf{V}^T\mathbf{D} \\
      &= \mathbf{\widetilde V}\mathbf{\widetilde\Lambda}\mathbf{\widetilde V}^T.
      \end{aligned}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right">
                        <mml:mover>
                          <mml:mi>ğ</mml:mi>
                          <mml:mo accent="true">Ìƒ</mml:mo>
                        </mml:mover>
                      </mml:mtd>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:mi>ğƒ</mml:mi>
                        <mml:msup>
                          <mml:mi>ğ</mml:mi>
                          <mml:mrow>
                            <mml:mi>Î½</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mi>ğƒ</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right"/>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:mi>ğƒ</mml:mi>
                        <mml:mi>ğ•</mml:mi>
                        <mml:msup>
                          <mml:mi>ğš²</mml:mi>
                          <mml:mrow>
                            <mml:mi>Î½</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mi>ğ•</mml:mi>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mi>ğƒ</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right"/>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:mover>
                          <mml:mi>ğ•</mml:mi>
                          <mml:mo accent="true">Ìƒ</mml:mo>
                        </mml:mover>
                        <mml:mover>
                          <mml:mi>ğš²</mml:mi>
                          <mml:mo accent="true">Ìƒ</mml:mo>
                        </mml:mover>
                        <mml:msup>
                          <mml:mover>
                            <mml:mi>ğ•</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mi>.</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>In practice, we donâ€™t scale the whole eigendecomposition.
      Instead, we rescale each value/vector pair individually as we
      iterate over the eigenvectors and values of
      <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      to create the corresponding values and vectors for the larger
      matrix.</p>
        </sec>
        <sec id="step-4-efficient-computation-of-log-density">
          <title>Step 4: Efficient Computation of Log-Density</title>
          <p>Using this scaled eigendecomposition, we efficiently
      compute:</p>
          <list list-type="order">
            <list-item>
              <p>Log-determinant: <inline-formula><alternatives><tex-math><![CDATA[\log|\mathbf{\widetilde Q}| = \sum_{i,j} \log(\widetilde\lambda_{ij})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>ğ</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[\widetilde\lambda_{ij}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
          is <inline-formula><alternatives><tex-math><![CDATA[\left( \left\{\lambda_{\rho_1}\right\}_i + \left\{\lambda_{\rho_2}\right\}_j \right)^{\nu+1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
          after rescaling with marginal standard deviations.</p>
            </list-item>
            <list-item>
              <p>Quadratic form: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z}^T\mathbf{\widetilde Q}\mathbf{z} = \sum_{i,j} (\widetilde\lambda_{ij}) y_{ij}^2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mover><mml:mi>ğ</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[y_{ij} = \left(\left\{\mathbf{v}_{\rho_1}\right\}_i \otimes \left\{\mathbf{v}_{\rho_2}\right\}_j\right)^T\mathbf{z}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ³</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
            </list-item>
          </list>
          <p>This approach allows us to calculate the density of the spatial
      copula by calculating and iterating over the spectral
      decomposition of the smaller matrices, avoiding the formation of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      alltogether.</p>
        </sec>
      </sec>
      <sec id="circulant-and-folded-circulant-approximations">
        <title>Circulant and Folded Circulant Approximations</title>
        <p>While the eigendecomposition method provides an exact solution,
    it can be computationally expensive for very large spatial fields.
    To address this, we introduce circulant and folded circulant
    approximations that offer potential computational advantages.</p>
        <sec id="circulant-matrices">
          <title>Circulant Matrices</title>
          <p>A circulant matrix <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
      is a special kind of matrix where each row is a cyclic shift of
      the row above it. It can be fully specified by its first row or
      column, called the base <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      C = \begin{pmatrix}
      c_0 & c_1 & c_2 & \cdots & c_{n-1} \\
      c_{n-1} & c_0 & c_1 & \cdots & c_{n-2} \\
      c_{n-2} & c_{n-1} & c_0 & \cdots & c_{n-3} \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      c_1 & c_2 & c_3 & \cdots & c_0
      \end{pmatrix} = (c_{j-i \mod n})
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>3</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>c</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>c</mml:mi>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>âˆ’</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mspace width="0.444em"/>
                            <mml:mo>mod</mml:mo>
                            <mml:mspace width="0.222em"/>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>The base vector <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
      completely determines the circulant matrix and plays a crucial
      role in efficient computations. In particular:</p>
          <list list-type="order">
            <list-item>
              <p>The eigenvalues of <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          are given by the Discrete Fourier Transform (DFT) of
          <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>:
          <disp-formula><alternatives><tex-math><![CDATA[
          \lambda = \text{DFT}(c)
          ]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block"><mml:mrow><mml:mi>Î»</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">DFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
            </list-item>
            <list-item>
              <p>Matrix-vector multiplication can be performed using the
          FFT: <disp-formula><alternatives><tex-math><![CDATA[
          Cv = \text{DFT}(\text{DFT}(c) \odot \text{IDFT}(v))
          ]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block"><mml:mrow><mml:mi>C</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">DFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="normal">DFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âŠ™</mml:mo><mml:mtext mathvariant="normal">IDFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
            </list-item>
            <list-item>
              <p>When <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          is non singular, then the inverse is circulant and thus
          determined by its base:</p>
            </list-item>
          </list>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \frac1n \text{IDFT}(\text{DFT}(c)^{-1}).
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mi>n</mml:mi>
                    </mml:mfrac>
                    <mml:mtext mathvariant="normal">IDFT</mml:mtext>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mtext mathvariant="normal">DFT</mml:mtext>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>c</mml:mi>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>.</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>These properties allow for much faster computations than for
      general matrices.</p>
        </sec>
        <sec id="block-circulant-matrices">
          <title>Block Circulant Matrices</title>
          <p>For two-dimensional spatial fields, we use block circulant
      matrices with circulant blocks (BCCB). An
      <inline-formula><alternatives><tex-math><![CDATA[Nn \times Nn]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>N</mml:mi><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      matrix C is block circulant if it has the form:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      C = \begin{pmatrix}
      C_0 & C_1 & C_2 & \cdots & C_{N-1} \\
      C_{N-1} & C_0 & C_1 & \cdots & C_{N-2} \\
      C_{N-2} & C_{N-1} & C_0 & \cdots & C_{N-3} \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      C_1 & C_2 & C_3 & \cdots & C_0
      \end{pmatrix} = (C_{j-i \mod N})
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>3</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>C</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>C</mml:mi>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>âˆ’</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mrow>
                            <mml:mspace width="0.444em"/>
                            <mml:mo>mod</mml:mo>
                            <mml:mspace width="0.222em"/>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where each <inline-formula><alternatives><tex-math><![CDATA[C_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is itself a circulant <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      matrix.</p>
          <p>For a BCCB matrix, we define a base matrix
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>,
      which is an <inline-formula><alternatives><tex-math><![CDATA[n \times N]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      matrix where each column is the base vector of the corresponding
      circulant block. This base matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      completely determines the BCCB matrix and is central to efficient
      computations:</p>
          <list list-type="order">
            <list-item>
              <p>The eigenvalues of <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          are given by the 2D DFT of <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>.</p>
            </list-item>
            <list-item>
              <p>Matrix-vector multiplication can be performed using the 2D
          FFT.</p>
            </list-item>
            <list-item>
              <p>When <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          is non singular, then the inverse is also a BCCB matrix and
          thus determined by its base matrix.</p>
            </list-item>
          </list>
        </sec>
        <sec id="approximations-for-q_rho">
          <title>Approximations for <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula></title>
          <p>Let <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      be the precision matrix of a one-dimensional AR(1) process with
      correlation <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>.
      The exact form of <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q}_\rho = \frac{1}{1-\rho^2}
      \begin{bmatrix}
      1 & -\rho & 0 & \cdots & 0 \\
      -\rho & 1+\rho^2 & -\rho & \cdots & 0 \\
      0 & -\rho & 1+\rho^2 & \cdots & 0 \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      0 & 0 & 0 & \cdots & 1
      \end{bmatrix}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:mi>Ï</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>âˆ’</mml:mo>
                        <mml:msup>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <sec id="circulant-approximation">
            <title>Circulant Approximation</title>
            <p>The circulant approximation to <inline-formula><alternatives><tex-math><![CDATA[Q_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
        denoted as <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho^{(circ)}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>,
        is:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
        \mathbf{Q}_\rho^{(circ)} = \frac{1}{1-\rho^2}
        \begin{bmatrix}
        1+\rho^2 & -\rho & 0 & \cdots & 0 & -\rho \\
        -\rho & 1+\rho^2 & -\rho & \cdots & 0 & 0 \\
        0 & -\rho & 1+\rho^2 & \cdots & 0 & 0 \\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
        -\rho & 0 & 0 & \cdots & -\rho & 1+\rho^2
        \end{bmatrix}
        ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>ğ</mml:mi>
                        <mml:mi>Ï</mml:mi>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>c</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>r</mml:mi>
                          <mml:mi>c</mml:mi>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>âˆ’</mml:mo>
                          <mml:msup>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>This approximation treats the first and last observations as
        neighbors, effectively wrapping the data around a circle.</p>
          </sec>
          <sec id="folded-circulant-approximation">
            <title>Folded Circulant Approximation</title>
            <p>The folded circulant approximation,
        <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho^{(fold)}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>,
        is based on a reflected version of the data. We double the data
        by reflecting it, giving us the data
        <inline-formula><alternatives><tex-math><![CDATA[x_1,  \dots, x_n, x_n, \dots, x_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
        We then model this doubled data with a
        <inline-formula><alternatives><tex-math><![CDATA[2n \times 2n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
        circulant matrix. If written out as an
        <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
        matrix, it takes the form:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
        \mathbf{Q}_\rho^{(fold)} = \frac{1}{1-\rho^2}
        \begin{bmatrix}
        1-\rho+\rho^2 & -\rho & 0 & \cdots & 0 & 0 \\
        -\rho & 1+\rho^2 & -\rho & \cdots & 0 & 0 \\
        0 & -\rho & 1+\rho^2 & \cdots & 0 & 0 \\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & 0 & \cdots & -\rho & 1-\rho+\rho^2
        \end{bmatrix}
        ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>ğ</mml:mi>
                        <mml:mi>Ï</mml:mi>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mi>o</mml:mi>
                          <mml:mi>l</mml:mi>
                          <mml:mi>d</mml:mi>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>âˆ’</mml:mo>
                          <mml:msup>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>âˆ’</mml:mo>
                              <mml:mi>Ï</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>âˆ’</mml:mo>
                              <mml:mi>Ï</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>This approximation modifies the first and last diagonal
        elements to account for the reflection of the data. As
        <inline-formula><alternatives><tex-math><![CDATA[x_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        now is the first and last data point, then we avoid the circular
        dependence from the regular circulant approximation.</p>
          </sec>
        </sec>
        <sec id="extension-to-the-full-q-matrix">
          <title>Extension to the Full Q Matrix</title>
          <p>For a two-dimensional spatial field on an
      <inline-formula><alternatives><tex-math><![CDATA[n_1 \times n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      grid, we construct the full precision matrix Q using a Kronecker
      sum:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q} = \left( \mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2} \right)^{(\nu + 1)}, \quad \nu \in \{0, 1, 2\}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:msub>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ§</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ§</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:msub>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>Î½</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="1.0em"/>
                    <mml:mi>Î½</mml:mi>
                    <mml:mo>âˆˆ</mml:mo>
                    <mml:mo stretchy="false" form="prefix">{</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="false" form="postfix">}</mml:mo>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
      denotes the Kronecker product, <inline-formula><alternatives><tex-math><![CDATA[I_n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is the <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      identity matrix, and <inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>
      is a smoothness parameter.</p>
          <p>When we approximate <inline-formula><alternatives><tex-math><![CDATA[Q_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      with a circulant matrix, this Kronecker sum results in a
      block-circulant matrix with circulant blocks (BCCB). To see this,
      letâ€™s consider the case where <inline-formula><alternatives><tex-math><![CDATA[\nu = 0]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
      for simplicity:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q} = \mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:msub>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ§</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ§</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:msub>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:msub>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>Now, let the two AR(1) matrices be approximated by a circulant
      matrix <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
      with base vector <inline-formula><alternatives><tex-math><![CDATA[c = [c_, c_1, ..., c_{n-1}]]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mo>,</mml:mo></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
      Then:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q}_{\rho_1} \approx \mathbf{C_{\rho_1}} = \frac{1}{1-\rho_1^2}
      \begin{bmatrix}
      1+\rho_1^2 & -\rho_1 & 0 & \cdots & 0 & -\rho_1 \\
      -\rho_1 & 1+\rho_1^2 & -\rho_1 & \cdots & 0 & 0 \\
      0 & -\rho_1 & 1+\rho_1^2 & \cdots & 0 & 0 \\
      \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
      -\rho_1 & 0 & 0 & \cdots & -\rho_1 & 1+\rho_1^2
      \end{bmatrix},
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:msub>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>â‰ˆ</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ‚</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ›’</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>âˆ’</mml:mo>
                        <mml:msubsup>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>1</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>and <inline-formula><alternatives><tex-math><![CDATA[C_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      is defined similarly. The Kronecker product
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf C_{\rho_1} \otimes \mathbf I_{n_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğ‚</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>ğˆ</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      results in a block matrix where each block is a scalar multiple of
      <inline-formula><alternatives><tex-math><![CDATA[I_{n_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{C_{\rho_1}} \otimes \mathbf{I_{n_2}} = \frac{1}{1-\rho_1^2}
      \begin{pmatrix}
      (1+\rho_1^2)\mathbf{I_{n_2}} & -\rho_1\mathbf{I_{n_2}} & \dots & \cdots & -\rho_1\mathbf{I_{n_2}} \\
      -\rho_1\mathbf{I_{n_2}} & (1+\rho_1^2)\mathbf{I_{n_2}} & -\rho_1 \mathbf{I_{n_2}} & \cdots & \vdots  \\
      \vdots & \ddots & \ddots & \ddots & \vdots \\
      \vdots & \ddots & -\rho_1\mathbf{I_{n_2}} & (1+\rho_1^2)\mathbf{I_{n_2}} & -\rho_1 \mathbf{I_{n_2}}  \\
      -\rho_1\mathbf{I_{n_2}} & \dots & \cdots & -\rho_1 \mathbf{I_{n_2}} & (1+\rho_1^2)\mathbf{I_{n_2}}
      \end{pmatrix}.
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ğ‚</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ›’</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ§</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>âˆ’</mml:mo>
                        <mml:msubsup>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>1</mml:mn>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â€¦</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â€¦</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:msub>
                              <mml:mi>ğˆ</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>.</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>Similarly, <inline-formula><alternatives><tex-math><![CDATA[\mathbf I_{n_1} \otimes \mathbf C_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğˆ</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>ğ‚</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      results in a block diagonal matrix where each block is a copy of
      <inline-formula><alternatives><tex-math><![CDATA[C_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{I_{n_1}} \otimes \mathbf{C_{\rho_2}} = 
      \begin{pmatrix}
      \mathbf{C_{\rho_2}} & \mathbf{0} & \cdots & \mathbf{0} \\
      \mathbf{0} & \mathbf{C_{\rho_2}} & \cdots & \mathbf{0} \\
      \vdots & \vdots & \ddots & \vdots \\
      \mathbf{0} & \mathbf{0} & \cdots & \mathbf{C_{\rho_2}}
      \end{pmatrix}.
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ§</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ‚</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ›’</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ‚</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ›’</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>ğŸ</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>ğŸ</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>ğŸ</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ‚</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ›’</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>ğŸ</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>ğŸ</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>ğŸ</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ‚</mml:mi>
                              <mml:msub>
                                <mml:mi>ğ›’</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>.</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>The sum of these two matrices is a block-circulant matrix with
      circulant blocks:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q} \approx \mathbf C_{\rho_1} \otimes \mathbf I_{n_2} + \mathbf I_{n_1} \otimes \mathbf C_{\rho_2} = 
      \begin{pmatrix}
      \mathbf{B}_0 & \mathbf{B}_1 & \cdots & \mathbf{B}_{n_1-1} \\
      \mathbf{B}_{n_1-1} & \mathbf{B}_0 & \cdots & \mathbf{B}_{n_1-2} \\
      \vdots & \vdots & \ddots & \vdots \\
      \mathbf{B}_1 & \mathbf{B}_2 & \cdots & \mathbf{B}_0
      \end{pmatrix}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo>â‰ˆ</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ‚</mml:mi>
                      <mml:msub>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ‚</mml:mi>
                      <mml:msub>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>n</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>n</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>n</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:msub>
                              <mml:mi>ğ</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:msub>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where each <inline-formula><alternatives><tex-math><![CDATA[\mathbf{B_i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>ğ¢</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is a circulant matrix. Specifically,</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \begin{aligned}
      \mathbf{B_0} &= \frac{(1+\rho_1^2)}{(1 - \rho_1^2)}\mathbf{I_{n_2}} + \mathbf C_{\rho_2}, \quad \text{and} \\
      \mathbf{B_1} &= \mathbf{B_{n_1 - 1}} = \frac{-\rho_1}{(1 - \rho_1^2)}\mathbf{I_{n_2}}.
      \end{aligned}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right">
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>âˆ’</mml:mo>
                            <mml:msubsup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:msub>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ§</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ‚</mml:mi>
                          <mml:msub>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="1.0em"/>
                        <mml:mtext mathvariant="normal">and</mml:mtext>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right">
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>ğ§</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                            <mml:mo mathvariant="bold">âˆ’</mml:mo>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mi>âˆ’</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>âˆ’</mml:mo>
                            <mml:msubsup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:msub>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ§</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mi>.</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>This BCCB structure allows us to use 2D FFT for efficient
      computations. The base matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      for this BCCB structure is:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{c} = \begin{bmatrix}
      \frac{(1+\rho_1^2)}{(1 - \rho_1^2)} + \frac{(1+\rho_2^2)}{(1 - \rho_2^2)} & \frac{-\rho_1}{(1 - \rho_1^2)} & 0 & \cdots  & \frac{-\rho_1}{(1 - \rho_1^2)} \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0 \\
      0 & 0 & 0 & \cdots  & 0 \\
      \vdots & \vdots & \vdots & \ddots &  \vdots \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0
      \end{bmatrix}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğœ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mo>+</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>This base matrix <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
      captures the structure of the precision matrix
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      and allows for efficient computation of eigenvalues using the 2D
      Fast Fourier Transform (FFT), enabling rapid calculation of the
      log-determinant and quadratic forms needed for the Gaussian copula
      density.</p>
        </sec>
      </sec>
      <sec id="computation-with-circulant-approximation">
        <title>Computation with Circulant Approximation</title>
        <p>When using the circulant approximation, we leverage the efficient
    computation properties of block circulant matrices with circulant
    blocks (BCCB). This approach significantly reduces the computational
    complexity, especially for large spatial fields. Hereâ€™s the
    step-by-step process:</p>
        <sec id="construct-the-base-matrix">
          <title>1. Construct the Base Matrix</title>
          <p>First, we construct the base matrix
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      for our BCCB approximation of <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>.
      For an <inline-formula><alternatives><tex-math><![CDATA[n_1 \times n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      grid, <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      is an <inline-formula><alternatives><tex-math><![CDATA[n_2 \times n_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      matrix:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{c} = \begin{bmatrix}
      \frac{(1+\rho_1^2)}{(1 - \rho_1^2)} + \frac{(1+\rho_2^2)}{(1 - \rho_2^2)} & \frac{-\rho_1}{(1 - \rho_1^2)} & 0 & \cdots  & \frac{-\rho_1}{(1 - \rho_1^2)} \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0 \\
      0 & 0 & 0 & \cdots  & 0 \\
      \vdots & \vdots & \vdots & \ddots &  \vdots \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0
      \end{bmatrix}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğœ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mo>+</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>âˆ’</mml:mi>
                                <mml:msub>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>This base matrix encapsulates the structure of our MatÃ©rn-like
      precision matrix.</p>
        </sec>
        <sec id="compute-initial-eigenvalues">
          <title>2. Compute Initial Eigenvalues</title>
          <p>We compute the initial eigenvalues of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      using the 2D Fast Fourier Transform (FFT) of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \boldsymbol{\Lambda} = \text{FFT2}(\mathbf{c})^{\nu+1}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğš²</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mtext mathvariant="normal">FFT2</mml:mtext>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>ğœ</mml:mi>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>Î½</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where Î½ is the smoothness parameter.</p>
        </sec>
        <sec id="compute-marginal-variance-and-rescale-eigenvalues">
          <title>3. Compute Marginal Variance and Rescale
      Eigenvalues</title>
          <p>An important property of Block Circulant with Circulant Blocks
      (BCCB) matrices is that the inverse of a BCCB matrix is also a
      BCCB matrix, and the marginal variance is the first element in its
      first circulant block. We use this to efficiently compute the
      marginal variance and rescale the eigenvalues:</p>
          <list list-type="alpha-lower">
            <list-item>
              <p>Compute the element-wise inverse of
          <inline-formula><alternatives><tex-math><![CDATA[\boldsymbol{\Lambda}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğš²</mml:mi></mml:math></alternatives></inline-formula>:
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Lambda^{inv}} = 1 / \boldsymbol{\Lambda}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğš²</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>ğš²</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
            <list-item>
              <p>Compute the base of <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
          using inverse 2D FFT: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{c_{inv}} = \text{IFFT2}(\mathbf{{\Lambda^{inv}}})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğœ</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">IFFT2</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>ğš²</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
            <list-item>
              <p>The marginal variance is given by the first element of
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{c^{inv}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>ğœ</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>:
          <inline-formula><alternatives><tex-math><![CDATA[\sigma^2 = \mathbf{c^{inv}}_{(0,0)}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>Ïƒ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:msup><mml:mi>ğœ</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
            <list-item>
              <p>Rescale the eigenvalues: <inline-formula><alternatives><tex-math><![CDATA[\boldsymbol{\widetilde \Lambda} = \sigma^2 \boldsymbol{\Lambda}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mover><mml:mi>ğš²</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi>Ïƒ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ğš²</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
          </list>
          <p>This process ensures that the resulting precision matrix will
      have unit marginal variances, as required for the Gaussian
      copula.</p>
        </sec>
        <sec id="compute-log-determinant">
          <title>4. Compute Log-Determinant</title>
          <p>The log-determinant of the scaled
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\widetilde Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mover><mml:mi>ğ</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
      can be efficiently calculated as the sum of the logarithms of the
      scaled eigenvalues:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \log|\mathbf{Q}| = \sum_{i,j} \log(\widetilde \Lambda_{ij})
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">|</mml:mo>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo stretchy="true" form="postfix">|</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:munder>
                      <mml:mo>âˆ‘</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mover>
                          <mml:mi>Î›</mml:mi>
                          <mml:mo accent="true">Ìƒ</mml:mo>
                        </mml:mover>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
        </sec>
        <sec id="compute-quadratic-form">
          <title>5. Compute Quadratic Form</title>
          <p>To compute the quadratic form <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z}^T\mathbf{Q}\mathbf{z}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ</mml:mi><mml:mi>ğ³</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
      we use the following steps:</p>
          <list list-type="alpha-lower">
            <list-item>
              <p>Compute the 2D FFT of z: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\hat{z}} = \text{FFT2}(\mathbf{z})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mover><mml:mi>ğ³</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">FFT2</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ³</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
            <list-item>
              <p>Multiply element-wise with the scaled eigenvalues:
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\hat{y}} = \boldsymbol{\widetilde \Lambda} \odot \mathbf{\hat{z}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mover><mml:mi>ğ²</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover><mml:mi>ğš²</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo>âŠ™</mml:mo><mml:mover><mml:mi>ğ³</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
            <list-item>
              <p>Compute the inverse 2D FFT: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{y} = \text{IFFT2}(\mathbf{\hat{y}})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ²</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">IFFT2</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mover><mml:mi>ğ²</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
            <list-item>
              <p>Compute the dot product: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z}^T\mathbf{Q}\mathbf{z} = \mathbf{z}^T\mathbf{y}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ</mml:mi><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ²</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
          </list>
        </sec>
        <sec id="compute-the-log-density">
          <title>6. Compute the Log-Density</title>
          <p>Finally, we can compute the log-density of the Gaussian
      copula:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \log c(\mathbf{u}) = \frac{1}{2}\log|\mathbf{Q}| - \frac{1}{2}\mathbf{z}^T\mathbf{Q}\mathbf{z} + \frac{1}{2}\mathbf{z}^T\mathbf{z}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mo>log</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>ğ®</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">|</mml:mo>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo stretchy="true" form="postfix">|</mml:mo>
                    </mml:mrow>
                    <mml:mo>âˆ’</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi>ğ</mml:mi>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi>ğ³</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z} = \Phi^{-1}(\mathbf{u})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </sec>
      </sec>
      <sec id="computation-with-folded-circulant-approximation">
        <title>Computation with Folded Circulant Approximation</title>
        <p>The folded circulant approximation offers an alternative approach
    that can provide better accuracy near the edges of the spatial
    field. This method is based on the idea of reflecting the data along
    each coordinate axis, effectively doubling the size of the field.
    Other than that, the algorithmic implementation is the same except
    that the circulant approximation matrices to
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    are now <inline-formula><alternatives><tex-math><![CDATA[2n \times 2n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        <p>First, we reflect the data along each coordinate axis. For a 2D
    spatial field represented by an <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    matrix, the reflected data takes the form:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \begin{bmatrix}
    x_{11} & \cdots & x_{1n_2} & x_{1n_2} & \cdots & x_{11} \\
    \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
    x_{n_11} & \cdots & x_{n_1n_2} & x_{n_1n_2} & \cdots & x_{n_11} \\
    x_{n_11} & \cdots & x_{n_1n_2} & x_{n_1n_2} & \cdots & x_{n_11} \\
    \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
    x_{11} & \cdots & x_{1n_2} & x_{1n_2} & \cdots & x_{11}
    \end{bmatrix}
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mo stretchy="true" form="prefix">[</mml:mo>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mn>11</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mn>11</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mo>â‹±</mml:mo>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mo>â‹±</mml:mo>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mo>â‹±</mml:mo>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mo>â‹±</mml:mo>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹®</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mn>11</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:mi>â‹¯</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="center" style="text-align: center">
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mn>11</mml:mn>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo stretchy="true" form="postfix">]</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>This reflection creates a <inline-formula><alternatives><tex-math><![CDATA[2n_1 \times 2n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    matrix. The matrix is then stacked in lexicographic order before
    entering into the quadratic forms.</p>
      </sec>
    </sec>
    <sec id="results">
      <title>Results</title>
      <sec id="computational-efficiency">
        <title>Computational Efficiency</title>
        <p>Table 1 presents the results of a benchmark comparing the time it
    takes to evaluate the gaussian copula density described above. For
    each grid size, we report the computation time for the exact method
    and the two approximations, along with the speed-up factor relative
    to the exact method. Each calculation was performed twenty times and
    the median times are shown in the table. The Cholesky method is
    described in the appendix.</p>
        <table-wrap>
          <caption>
            <p>Benchmarking how long it takes to evaluate the density of a
        MÃ¡tern(<inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>)-like
        field with correlation parameter <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
        scaled to have unit marginal variance</p>
          </caption>
          <table>
            <thead>
              <tr>
                <th rowspan="2" id="GridU0020Size" scope="col">Grid
            Size</th>
                <th rowspan="2" id="Cholesky" scope="col">Cholesky</th>
                <th colspan="2" id="Eigen" scope="colgroup">
                  <named-content content-type="gt_column_spanner">Eigen</named-content>
                </th>
                <th colspan="2" id="Circulant" scope="colgroup">
                  <named-content content-type="gt_column_spanner">Circulant</named-content>
                </th>
                <th colspan="2" id="Folded" scope="colgroup">
                  <named-content content-type="gt_column_spanner">Folded</named-content>
                </th>
              </tr>
              <tr>
                <th id="Time" scope="col">Time</th>
                <th id="Speed-up" scope="col">Speed-up</th>
                <th id="Time" scope="col">Time</th>
                <th id="Speed-Up" scope="col">Speed-Up</th>
                <th id="Time" scope="col">Time</th>
                <th id="Speed-Up" scope="col">Speed-Up</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td headers="Grid">10x10</td>
                <td headers="Cholesky">73.04Âµs</td>
                <td headers="eig">173.43Âµs</td>
                <td headers="sp_1">0.42x</td>
                <td headers="circ">31.9Âµs</td>
                <td headers="sp_2">2.29x</td>
                <td headers="fol">44.16Âµs</td>
                <td headers="sp_3">1.65x</td>
              </tr>
              <tr>
                <td headers="Grid">20x20</td>
                <td headers="Cholesky">1.43ms</td>
                <td headers="eig">267.01Âµs</td>
                <td headers="sp_1">5.36x</td>
                <td headers="circ">44Âµs</td>
                <td headers="sp_2">32.54x</td>
                <td headers="fol">151.74Âµs</td>
                <td headers="sp_3">9.44x</td>
              </tr>
              <tr>
                <td headers="Grid">30x30</td>
                <td headers="Cholesky">9.88ms</td>
                <td headers="eig">808.5Âµs</td>
                <td headers="sp_1">12.22x</td>
                <td headers="circ">110.2Âµs</td>
                <td headers="sp_2">89.63x</td>
                <td headers="fol">243.07Âµs</td>
                <td headers="sp_3">40.64x</td>
              </tr>
              <tr>
                <td headers="Grid">40x40</td>
                <td headers="Cholesky">37.88ms</td>
                <td headers="eig">2.06ms</td>
                <td headers="sp_1">18.35x</td>
                <td headers="circ">141.5Âµs</td>
                <td headers="sp_2">267.64x</td>
                <td headers="fol">393.79Âµs</td>
                <td headers="sp_3">96.18x</td>
              </tr>
              <tr>
                <td headers="Grid">50x50</td>
                <td headers="Cholesky">106.28ms</td>
                <td headers="eig">4.56ms</td>
                <td headers="sp_1">23.33x</td>
                <td headers="circ">188.5Âµs</td>
                <td headers="sp_2">563.82x</td>
                <td headers="fol">604.87Âµs</td>
                <td headers="sp_3">175.7x</td>
              </tr>
              <tr>
                <td headers="Grid">60x60</td>
                <td headers="Cholesky">253.66ms</td>
                <td headers="eig">8.79ms</td>
                <td headers="sp_1">28.86x</td>
                <td headers="circ">242.4Âµs</td>
                <td headers="sp_2">1046.59x</td>
                <td headers="fol">836.07Âµs</td>
                <td headers="sp_3">303.4x</td>
              </tr>
              <tr>
                <td headers="Grid">70x70</td>
                <td headers="Cholesky">538.42ms</td>
                <td headers="eig">16.81ms</td>
                <td headers="sp_1">32.04x</td>
                <td headers="circ">333.1Âµs</td>
                <td headers="sp_2">1616.37x</td>
                <td headers="fol">1.17ms</td>
                <td headers="sp_3">459.89x</td>
              </tr>
              <tr>
                <td headers="Grid">80x80</td>
                <td headers="Cholesky">1.02s</td>
                <td headers="eig">29.59ms</td>
                <td headers="sp_1">34.63x</td>
                <td headers="circ">393.9Âµs</td>
                <td headers="sp_2">2601.89x</td>
                <td headers="fol">1.59ms</td>
                <td headers="sp_3">643.46x</td>
              </tr>
              <tr>
                <td headers="Grid">90x90</td>
                <td headers="Cholesky">1.81s</td>
                <td headers="eig">48.56ms</td>
                <td headers="sp_1">37.27x</td>
                <td headers="circ">598.9Âµs</td>
                <td headers="sp_2">3022.23x</td>
                <td headers="fol">2.04ms</td>
                <td headers="sp_3">888.28x</td>
              </tr>
              <tr>
                <td headers="Grid">100x100</td>
                <td headers="Cholesky">3.09s</td>
                <td headers="eig">76.03ms</td>
                <td headers="sp_1">40.59x</td>
                <td headers="circ">593Âµs</td>
                <td headers="sp_2">5204.38x</td>
                <td headers="fol">2.42ms</td>
                <td headers="sp_3">1276.46x</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
    </sec>
    <sec id="appendix">
      <title>Appendix</title>
      <sec id="cholesky-methods">
        <title>Cholesky Methods</title>
        <p>Standard methods of evaluating multivariate normal densities
    using the Cholesky decomposition were implemented to compare with
    the new methods for benchmarking.</p>
        <sec id="unscaled-precision-matrix">
          <title>Unscaled Precision Matrix</title>
          <sec id="precision-matrix-construction">
            <title>Precision Matrix Construction</title>
            <p>We start by constructing the precision matrix
        <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
        for a 2D MatÃ©rn field on a grid of size
        <inline-formula><alternatives><tex-math><![CDATA[d_x \times d_y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
        Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2 
        ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>Q</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>Q</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>I</mml:mi>
                        <mml:msub>
                          <mml:mi>d</mml:mi>
                          <mml:mi>y</mml:mi>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>I</mml:mi>
                        <mml:msub>
                          <mml:mi>d</mml:mi>
                          <mml:mi>x</mml:mi>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>Q</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
        denotes the Kronecker product, <inline-formula><alternatives><tex-math><![CDATA[Q_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        are 1D precision matrices for the x and y dimensions
        respectively (typically AR(1)-like structures), and
        <inline-formula><alternatives><tex-math><![CDATA[I_{d_x}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[I_{d_y}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        are identity matrices of appropriate sizes.</p>
          </sec>
          <sec id="density-computation">
            <title>Density Computation</title>
            <p>For a MatÃ©rn field with smoothness parameter
        <inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>,
        we need to work with <inline-formula><alternatives><tex-math><![CDATA[Q^{\nu+1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.
        We can efficiently compute the log-determinant,
        <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
        and the quadratic form, <inline-formula><alternatives><tex-math><![CDATA[x^T Q^{\nu+1} x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
        without explicitly forming <inline-formula><alternatives><tex-math><![CDATA[Q^{\nu+1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.
        To do this, we compute the Cholesky decomposition,
        <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>,
        where L is a lower triangular matrix, and make use of the
        following equations:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
        \log|Q^{\nu+1}| = (\nu+1)\log|Q| = 2(\nu+1)\sum_{i}\log(L_{ii}), 
        ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">|</mml:mo>
                        <mml:msup>
                          <mml:mi>Q</mml:mi>
                          <mml:mrow>
                            <mml:mi>Î½</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo stretchy="true" form="postfix">|</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>Î½</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">|</mml:mo>
                        <mml:mi>Q</mml:mi>
                        <mml:mo stretchy="true" form="postfix">|</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>Î½</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:munder>
                        <mml:mo>âˆ‘</mml:mo>
                        <mml:mi>i</mml:mi>
                      </mml:munder>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>L</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
        \begin{aligned}
        x^T Q x &= x^T L L^T x = ||L^T x||_2^2 \\
        x^T Q^2 x &=  x^T L L^T L L^T x = ||LL^T x||_2^2 \\
        x^T Q^3 x &=  x^T L L^T L L^T L L^T x = ||L^TLL^T x||_2^2.
        \end{aligned}
        ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right">
                          <mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>Q</mml:mi>
                          <mml:mi>x</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">|</mml:mo>
                            <mml:mo stretchy="true" form="postfix">|</mml:mo>
                          </mml:mrow>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">|</mml:mo>
                              <mml:mo stretchy="true" form="postfix">|</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right">
                          <mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:msup>
                            <mml:mi>Q</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">|</mml:mo>
                            <mml:mo stretchy="true" form="postfix">|</mml:mo>
                          </mml:mrow>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">|</mml:mo>
                              <mml:mo stretchy="true" form="postfix">|</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right">
                          <mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:msup>
                            <mml:mi>Q</mml:mi>
                            <mml:mn>3</mml:mn>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">|</mml:mo>
                            <mml:mo stretchy="true" form="postfix">|</mml:mo>
                          </mml:mrow>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>L</mml:mi>
                          <mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>x</mml:mi>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">|</mml:mo>
                              <mml:mo stretchy="true" form="postfix">|</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                          <mml:mi>.</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
          </sec>
          <sec id="algorithm">
            <title>Algorithm</title>
            <list list-type="order">
              <list-item>
                <p>Construct <inline-formula><alternatives><tex-math><![CDATA[Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute Cholesky decomposition
            <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute log-determinant: <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}| = 2(\nu+1)\sum_{i}\log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>For each observation <inline-formula><alternatives><tex-math><![CDATA[x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>:</p>
                <list list-type="roman-lower">
                  <list-item>
                    <label>i)</label>
                    <p>Initialize <inline-formula><alternatives><tex-math><![CDATA[y = x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                  </list-item>
                  <list-item>
                    <label>ii)</label>
                    <p>For <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
                from 0 to <inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>:</p>
                    <list list-type="bullet">
                      <list-item>
                        <p>If <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
                    is even: <inline-formula><alternatives><tex-math><![CDATA[y = L^T y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                      </list-item>
                      <list-item>
                        <p>If <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
                    is odd: <inline-formula><alternatives><tex-math><![CDATA[y = L y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                      </list-item>
                    </list>
                  </list-item>
                  <list-item>
                    <label>iii)</label>
                    <p>Compute quadratic form <inline-formula><alternatives><tex-math><![CDATA[q = y^Ty]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                  </list-item>
                </list>
              </list-item>
              <list-item>
                <p>Compute log-density: <inline-formula><alternatives><tex-math><![CDATA[\log p(x) = -\frac{1}{2}(d\log(2\pi) + \log|Q^{\nu+1}| + q)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>âˆ’</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>d</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mi>Ï€</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
            </list>
          </sec>
        </sec>
        <sec id="scaled-precision-matrix">
          <title>Scaled Precision Matrix</title>
          <sec id="precision-matrix-construction-1">
            <title>Precision Matrix Construction</title>
            <p>We start by constructing the precision matrix
        <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
        for a 2D MatÃ©rn field on a grid of size
        <inline-formula><alternatives><tex-math><![CDATA[d_x \times d_y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
        Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2 
        ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>Q</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>Q</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>I</mml:mi>
                        <mml:msub>
                          <mml:mi>d</mml:mi>
                          <mml:mi>y</mml:mi>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>I</mml:mi>
                        <mml:msub>
                          <mml:mi>d</mml:mi>
                          <mml:mi>x</mml:mi>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>Q</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
        denotes the Kronecker product, <inline-formula><alternatives><tex-math><![CDATA[Q_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        are 1D precision matrices for the x and y dimensions
        respectively (typically AR(1)-like structures), and
        <inline-formula><alternatives><tex-math><![CDATA[I_{d_x}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[I_{d_y}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        are identity matrices of appropriate sizes. We will then have to
        work with the matrix <inline-formula><alternatives><tex-math><![CDATA[Q^{\nu + 1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.</p>
            <p>To ensure unit marginal variances, we need to scale this
        precision matrix. Let <inline-formula><alternatives><tex-math><![CDATA[D]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>
        be a diagonal matrix where <inline-formula><alternatives><tex-math><![CDATA[D_{ii} = \sqrt{\Sigma_{ii}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mi>Î£</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>,
        and <inline-formula><alternatives><tex-math><![CDATA[\Sigma = (Q^{\nu+1})^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î£</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.
        The scaled precision matrix is then:
        <disp-formula><alternatives><tex-math><![CDATA[
        \tilde{Q} = DQ^{\nu+1}D
        ]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block"><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
          </sec>
          <sec id="efficient-computation-of-scaling-matrix-d">
            <title>Efficient Computation of Scaling Matrix D</title>
            <list list-type="order">
              <list-item>
                <p>Compute the Cholesky decomposition of the original
            <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute <inline-formula><alternatives><tex-math><![CDATA[R = L^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>,
            so that <inline-formula><alternatives><tex-math><![CDATA[S = Q^{-1} = R^TR]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
              </list-item>
              <list-item>
                <p>We then calculate the entries in
            <inline-formula><alternatives><tex-math><![CDATA[D]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>
            using the following steps:</p>
                <list list-type="roman-lower">
                  <list-item>
                    <p>For <inline-formula><alternatives><tex-math><![CDATA[\nu = 0]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
                <inline-formula><alternatives><tex-math><![CDATA[D_{ii} = \sqrt{\Sigma_{ii}} = \sqrt{\sum_j (R_{ji})^2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mi>Î£</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>,
                the column-wise norm of <inline-formula><alternatives><tex-math><![CDATA[R]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula>.</p>
                  </list-item>
                  <list-item>
                    <p>For <inline-formula><alternatives><tex-math><![CDATA[\nu = 1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
                we use the column-wise norm of
                <inline-formula><alternatives><tex-math><![CDATA[R^TR]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                  </list-item>
                  <list-item>
                    <p>For <inline-formula><alternatives><tex-math><![CDATA[\nu = 2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
                we use the column-wise norm of
                <inline-formula><alternatives><tex-math><![CDATA[RR^TR]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                  </list-item>
                </list>
              </list-item>
            </list>
          </sec>
          <sec id="log-determinant">
            <title>Log determinant</title>
            <list list-type="order">
              <list-item>
                <p>First, note that <inline-formula><alternatives><tex-math><![CDATA[\log|\tilde{Q}| = \log|DQ^{\nu+1}D| = 2\log|D| + \log|Q^{\nu+1}|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>We can compute <inline-formula><alternatives><tex-math><![CDATA[\log|D|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
            directly from the diagonal elements of D,
            i.e.Â <inline-formula><alternatives><tex-math><![CDATA[\log|D| = \sum_i \log(D_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>For <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
            we can use the properties of the Cholesky decomposition:
            <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}| = (\nu+1)\log|Q| = (\nu+1)\log|LL^T| = 2(\nu+1)\sum_i \log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Combining these, we get <inline-formula><alternatives><tex-math><![CDATA[\log|\tilde{Q}| = 2\sum_i \log(D_{ii}) + 2(\nu+1)\sum_i \log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
            </list>
          </sec>
          <sec id="quadratic-form">
            <title>Quadratic Form</title>
            <list list-type="order">
              <list-item>
                <p>First, note that <inline-formula><alternatives><tex-math><![CDATA[z^T\tilde{Q}z = z^TDQ^{\nu+1}Dz = (Dz)^TQ^{\nu+1}(Dz)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>D</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Let <inline-formula><alternatives><tex-math><![CDATA[y = Dz]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
            We can compute this element-wise as
            <inline-formula><alternatives><tex-math><![CDATA[y_i = D_{ii}z_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Now we compute <inline-formula><alternatives><tex-math><![CDATA[y^TQ^{\nu+1}y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
            as in the unscaled case.</p>
              </list-item>
            </list>
          </sec>
          <sec id="algorithm-1">
            <title>Algorithm</title>
            <p>Putting it all together, hereâ€™s the algorithm for computing
        the log-density of the Gaussian copula using the scaled
        precision matrix:</p>
            <list list-type="order">
              <list-item>
                <p>Construct <inline-formula><alternatives><tex-math><![CDATA[Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute Cholesky decomposition
            <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute <inline-formula><alternatives><tex-math><![CDATA[R = L^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
            and use it to compute D as described earlier</p>
              </list-item>
              <list-item>
                <p>Compute log-determinant: <inline-formula><alternatives><tex-math><![CDATA[\log|\tilde{Q}| = 2\sum_i \log(D_{ii}) + 2(\nu+1)\sum_i \log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>For each observation <inline-formula><alternatives><tex-math><![CDATA[z = \Phi^{-1}(u)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>:</p>
                <list list-type="roman-lower">
                  <list-item>
                    <label>i)</label>
                    <p>Compute <inline-formula><alternatives><tex-math><![CDATA[y = Dz]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                  </list-item>
                  <list-item>
                    <label>ii)</label>
                    <p>Compute <inline-formula><alternatives><tex-math><![CDATA[y^TQ^{\nu+1}y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
                as in the unscaled case.</p>
                  </list-item>
                </list>
              </list-item>
              <list-item>
                <p>Compute log-density: <inline-formula><alternatives><tex-math><![CDATA[\log c(u) = -\frac{1}{2}(d\log(2\pi) + \log|\tilde{Q}| + q - z^Tz)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>âˆ’</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>d</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mi>Ï€</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo>âˆ’</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
            </list>
          </sec>
        </sec>
      </sec>
    </sec>
  </body>
  <back>
</back>
  <sub-article article-type="notebook" id="nb-3-nb-article">
    <front-stub>
      <title-group>
        <article-title>Efficient Gaussian Copula Density Computation for
Large-Scale Spatial Data: A MatÃ©rn-like GMRF Approach with Circulant and
Folded Circulant Approximations</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>JÃ³nsson</surname>
            <given-names>BrynjÃ³lfur Gauti GuÃ°rÃºnar</given-names>
          </name>
          <string-name>BrynjÃ³lfur Gauti GuÃ°rÃºnar JÃ³nsson</string-name>
          <email>brynjolfur@hi.is</email>
          <xref ref-type="aff" rid="aff-1-nb-article">a</xref>
        </contrib>
      </contrib-group>
      <aff id="aff-1-nb-article">
        <institution-wrap>
          <institution>University of Iceland</institution>
        </institution-wrap>
      </aff>
    </front-stub>
    <body>
      <sec specific-use="notebook-content">
        <code language="r script">library(tidyverse)</code>
        <boxed-text>
          <preformat>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4     âœ” readr     2.1.5
âœ” forcats   1.0.0     âœ” stringr   1.5.1
âœ” ggplot2   3.5.1     âœ” tibble    3.2.1
âœ” lubridate 1.9.3     âœ” tidyr     1.3.1
âœ” purrr     1.0.2     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
        </boxed-text>
        <code language="r script">library(glue)
library(gt)</code>
      </sec>
      <sec id="introduction-nb-article">
        <title>Introduction</title>
        <sec id="problem-formulation-nb-article">
          <title>Problem Formulation</title>
          <p>Consider a spatial field on a regular
    <inline-formula><alternatives><tex-math><![CDATA[n_1 \times n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    grid. Our objective is to compute the Gaussian copula density
    efficiently for this field. This computation involves:</p>
          <list list-type="order">
            <list-item>
              <p>Specifying an <inline-formula><alternatives><tex-math><![CDATA[n_1 n_2 \times n_1 n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
        precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
        that represents the spatial dependence structure.</p>
            </list-item>
            <list-item>
              <p>Ensuring the implied covariance matrix
        <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma} = \mathbf{Q}^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
        has unit diagonal elements.</p>
            </list-item>
            <list-item>
              <p>Computing the log determinant, <inline-formula><alternatives><tex-math><![CDATA[\log |\mathbf Q|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>ğ</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
        and the quadratic form <inline-formula><alternatives><tex-math><![CDATA[z^T \mathbf Q z]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
        where <inline-formula><alternatives><tex-math><![CDATA[z_i = \Phi^{-1}(f_i(y_i))]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
          </list>
        </sec>
        <sec id="review-nb-article">
          <title>Review</title>
          <p>Gaussian Markov Random Fields (GMRFs) and copulas are two
    powerful statistical tools, each offering unique strengths in
    modeling complex data structures. GMRFs excel in capturing spatial
    and temporal dependencies, particularly in fields such as
    environmental science, epidemiology, and image analysis. Their
    ability to represent local dependencies through sparse precision
    matrices makes them computationally attractive for high-dimensional
    problems. Copulas, on the other hand, provide a flexible framework
    for modeling multivariate dependencies, allowing separate
    specification of marginal distributions and their joint
    behavior.</p>
          <p>The Gaussian copula, in particular, has gained popularity due to
    its interpretability and connection to the multivariate normal
    distribution. However, combining GMRFs with copulas has historically
    been computationally challenging, limiting their joint application
    to smaller datasets or simpler models.</p>
          <p>Let <inline-formula><alternatives><tex-math><![CDATA[\mathbf{X} = (X_1, X_2, \ldots, X_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ—</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    be a multivariate random vector with marginal distribution functions
    <inline-formula><alternatives><tex-math><![CDATA[F_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    for <inline-formula><alternatives><tex-math><![CDATA[i = 1, 2, \ldots, n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
    The joint distribution function of <inline-formula><alternatives><tex-math><![CDATA[\mathbf{X}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ—</mml:mi></mml:math></alternatives></inline-formula>
    can be written as:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    F_{\mathbf{X}}(\mathbf{x}) = C(F_1(x_1), F_2(x_2), \ldots, F_n(x_n)),
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>F</mml:mi>
                      <mml:mi>ğ—</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>ğ±</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>F</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>F</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mi>â€¦</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>F</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mi>n</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is the Gaussian copula defined by the GMRF precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>.
    The Gaussian copula <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is given by:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    C(u_1, u_2, \ldots, u_n) = \Phi_\mathbf{Q}(\Phi^{-1}(u_1), \Phi^{-1}(u_2), \ldots, \Phi^{-1}(u_n)),
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mi>â€¦</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>Î¦</mml:mi>
                      <mml:mi>ğ</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msup>
                        <mml:mi>Î¦</mml:mi>
                        <mml:mrow>
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>u</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mi>Î¦</mml:mi>
                        <mml:mrow>
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>u</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                      <mml:mi>â€¦</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mi>Î¦</mml:mi>
                        <mml:mrow>
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>u</mml:mi>
                          <mml:mi>n</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\Phi_\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Î¦</mml:mi><mml:mi>ğ</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the joint cumulative distribution function of a multivariate
    normal distribution with mean vector <inline-formula><alternatives><tex-math><![CDATA[\mathbf{0}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mn>ğŸ</mml:mn></mml:math></alternatives></inline-formula>
    and precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Phi^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    is the inverse of the standard normal cumulative distribution
    function.</p>
          <p>A critical requirement for the precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    governing the GMRF copula <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is that <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma} = \mathbf{Q}^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
    should have a unit diagonal, i.e.Â the marginal variance is equal to
    one everywhere.. This ensures it operates on the same scale as the
    transformed data, <inline-formula><alternatives><tex-math><![CDATA[\Phi^{-1}(u_i)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
    However, this can be challenging as GMRFs are typically defined in
    terms of precision matrices that often imply non-unit marginal
    variances.</p>
          <p>This paper presents a novel algorithm that bridges the gap
    between GMRFs and copulas, allowing for fast and efficient
    computation of Gaussian copula densities using GMRF precision
    structures. Our method focuses on creating a MatÃ©rn-like precision
    matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    with unit marginal variance and efficiently computing the
    multivariate Gaussian copula density of
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Z} = \Phi^{-1}(\mathbf{u})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ™</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    where <inline-formula><alternatives><tex-math><![CDATA[u_i \sim \text{Uniform}(0, 1)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">Uniform</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[i = 1, \dots, n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
          <p>The key innovation lies in leveraging the special structure of
    the precision matrix:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \mathbf{Q} = \mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2},
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:msub>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ§</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:msub>
                        <mml:mi>ğ§</mml:mi>
                        <mml:mn>ğŸ</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>âŠ—</mml:mo>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:msub>
                        <mml:mi>Ï</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the precision matrix of a standardized one-dimensional AR(1)
    process with correlation <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
    denotes the Kronecker product. By employing efficient
    eigendecomposition techniques, our method avoids explicit formation
    and inversion of the large precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    making it particularly suitable for high-dimensional spatial data.
    In addition to the exact method, we show how the precision matrix
    can be approximated by a folded circulant matrix wich gives a large
    speed-up while preserving suitable boundary conditions.</p>
        </sec>
      </sec>
      <sec id="methods-nb-article">
        <title>Methods</title>
        <sec id="gaussian-copula-density-computation-nb-article">
          <title>Gaussian Copula Density Computation</title>
          <p>The Gaussian copula density for a random vector
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{U} = (U_1, ..., U_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ”</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    with <inline-formula><alternatives><tex-math><![CDATA[U_i \sim \text{Uniform}(0,1)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">Uniform</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is given by:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    c(\mathbf{u}) = |\mathbf{Q}|^{1/2} \exp\left(-\frac{1}{2}\mathbf{z}^T(\mathbf{Q} - \mathbf{I})\mathbf{z}\right)
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>ğ®</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">|</mml:mo>
                        <mml:mi>ğ</mml:mi>
                        <mml:mo stretchy="true" form="postfix">|</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mi>/</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>exp</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>âˆ’</mml:mi>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mn>2</mml:mn>
                      </mml:mfrac>
                      <mml:msup>
                        <mml:mi>ğ³</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>ğ</mml:mi>
                        <mml:mo>âˆ’</mml:mo>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z} = (z_1, ..., z_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    with <inline-formula><alternatives><tex-math><![CDATA[z_i = \Phi^{-1}(u_i)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    is the precision matrix, and <inline-formula><alternatives><tex-math><![CDATA[\mathbf{I}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğˆ</mml:mi></mml:math></alternatives></inline-formula>
    is the identity matrix.</p>
          <p>The log-density can be expressed as:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \log c(\mathbf{u}) = \frac{1}{2}\log|\mathbf{Q}| - \frac{1}{2}\mathbf{z}^T\mathbf{Q}\mathbf{z} + \frac{1}{2}\mathbf{z}^T\mathbf{z}
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mo>log</mml:mo>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>ğ®</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:mo>log</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">|</mml:mo>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo stretchy="true" form="postfix">|</mml:mo>
                    </mml:mrow>
                    <mml:mo>âˆ’</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi>ğ</mml:mi>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi>ğ³</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>Our goal is to efficiently compute this log-density for large
    spatial fields.</p>
        </sec>
        <sec id="precision-matrix-structure-nb-article">
          <title>Precision Matrix Structure</title>
          <p>We define the precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    as:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \mathbf{Q} = (\mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2})^{(\nu + 1)}, \quad \nu \in \{0, 1, 2\}
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:msub>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ§</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ§</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:msub>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>Î½</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="1.0em"/>
                    <mml:mi>Î½</mml:mi>
                    <mml:mo>âˆˆ</mml:mo>
                    <mml:mo stretchy="false" form="prefix">{</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="false" form="postfix">}</mml:mo>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the precision matrix of a one-dimensional AR(1) process with
    correlation <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \mathbf{Q}_\rho = \frac{1}{1-\rho^2}
    \begin{bmatrix}
    1 & -\rho & 0 & \cdots & 0 \\
    -\rho & 1+\rho^2 & -\rho & \cdots & 0 \\
    0 & -\rho & 1+\rho^2 & \cdots & 0 \\
    \vdots & \vdots & \vdots & \ddots & \vdots \\
    0 & 0 & 0 & \cdots & 1
    \end{bmatrix}
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:mi>Ï</mml:mi>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>âˆ’</mml:mo>
                        <mml:msup>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">[</mml:mo>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mi>Ï</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mo>â‹±</mml:mo>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹®</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>0</mml:mn>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mi>â‹¯</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="center" style="text-align: center">
                            <mml:mn>1</mml:mn>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mo stretchy="true" form="postfix">]</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>The matrix, <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    is then scaled so that its inverse, <inline-formula><alternatives><tex-math><![CDATA[\mathbf \Sigma = \mathbf Q^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
    is a correlation matrix, i.e.Â <inline-formula><alternatives><tex-math><![CDATA[\mathbf \Sigma_{ii} = 1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğšº</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </sec>
        <sec id="computation-process-nb-article">
          <title>Computation Process</title>
          <sec id="step-1-eigendecomposition-of-mathbfq_rho-nb-article">
            <title>Step 1: Eigendecomposition of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula></title>
            <p>We first compute the eigendecomposition of both
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>$:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{Q}_{\rho} = \mathbf{V_{\rho}}\mathbf{\Lambda_\rho}\mathbf{V_\rho}^T
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:mi>Ï</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ•</mml:mi>
                        <mml:mi>ğ›’</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>ğš²</mml:mi>
                        <mml:mi>ğ›’</mml:mi>
                      </mml:msub>
                      <mml:msup>
                        <mml:msub>
                          <mml:mi>ğ•</mml:mi>
                          <mml:mi>ğ›’</mml:mi>
                        </mml:msub>
                        <mml:mi>T</mml:mi>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{V_\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ•</mml:mi><mml:mi>ğ›’</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is the matrix of eigenvectors and <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Lambda_\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğš²</mml:mi><mml:mi>ğ›’</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is the diagonal matrix of eigenvalues. Then, because of how
      <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
      is defined, its eigendecomposition is:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{Q} = (\mathbf{V_{\rho_1}} \otimes \mathbf{V_{\rho_2}})(\mathbf{\Lambda_{\rho_1}} \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{\Lambda_{\rho_2}})^{(\nu + 1)}(\mathbf{V_{\rho_1}} \otimes \mathbf{V_{\rho_2}})^T.
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ•</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ›’</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ•</mml:mi>
                          <mml:msub>
                            <mml:mi>ğ›’</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:msub>
                            <mml:mi>ğš²</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ›’</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo>âŠ—</mml:mo>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>ğˆ</mml:mi>
                          <mml:mo>âŠ—</mml:mo>
                          <mml:msub>
                            <mml:mi>ğš²</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ›’</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>Î½</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:msub>
                            <mml:mi>ğ•</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ›’</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo>âŠ—</mml:mo>
                          <mml:msub>
                            <mml:mi>ğ•</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ›’</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:msup>
                      <mml:mi>.</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>We donâ€™t work with the full eigendecomposition, but rather
      utilize the fact that the eigenvalues of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      are <inline-formula><alternatives><tex-math><![CDATA[\left\{\lambda_{\rho_1}\right\}_i + \left\{\lambda_{\rho_2}\right\}_j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      and their corresponding eigenvectors are
      <inline-formula><alternatives><tex-math><![CDATA[\left\{\mathbf{v}_{\rho_1}\right\}_i \otimes \left\{\mathbf{v}_{\rho_2}\right\}_j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      to iterate over each value and vector pair to compute the density
      without forming the larger matrix.</p>
          </sec>
          <sec id="step-2-computation-of-marginal-standard-deviations-nb-article">
            <title>Step 2: Computation of Marginal Standard Deviations</title>
            <p>In order to scale <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      so that its inverse is a correlation matrix, we first calculate
      <inline-formula><alternatives><tex-math><![CDATA[\sigma_i = \sqrt\Sigma_{ii}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:msqrt><mml:mi>Î£</mml:mi></mml:msqrt><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives><tex-math><![CDATA[i = 1, \dots, n_1n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
      We then use these marginal standard deviations to scale the
      eigenvectors and values. The inverse of
      <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
      is given by:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \boldsymbol \Sigma = \mathbf Q^{-1} = (VAV^T)^{-1} = VA^{-1}V
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğšº</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msup>
                        <mml:mi>ğ</mml:mi>
                        <mml:mrow>
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>=</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>V</mml:mi>
                          <mml:mi>A</mml:mi>
                          <mml:msup>
                            <mml:mi>V</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>=</mml:mo>
                      <mml:mi>V</mml:mi>
                      <mml:msup>
                        <mml:mi>A</mml:mi>
                        <mml:mrow>
                          <mml:mi>âˆ’</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mi>V</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>The diagonal elements, <inline-formula><alternatives><tex-math><![CDATA[\boldsymbol \Sigma_{ii}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğšº</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
      are given by:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \Sigma_{ii} = \sum_{k=1}^{n} v_{ik} \frac{1}{\lambda_k} (v^T)_{ki} = \sum_{k=1}^{n} v_{ik} \frac{1}{\lambda_k} v_{ik} = \sum_{k=1}^{n} v_{ik}^2 \frac{1}{\lambda_k}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>Î£</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:munderover>
                        <mml:mo>âˆ‘</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:munderover>
                      <mml:msub>
                        <mml:mi>v</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:msub>
                          <mml:mi>Î»</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:msup>
                            <mml:mi>v</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:munderover>
                        <mml:mo>âˆ‘</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:munderover>
                      <mml:msub>
                        <mml:mi>v</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:msub>
                          <mml:mi>Î»</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                      <mml:msub>
                        <mml:mi>v</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:munderover>
                        <mml:mo>âˆ‘</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:munderover>
                      <mml:msubsup>
                        <mml:mi>v</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:msub>
                          <mml:mi>Î»</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msub>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>This means that the <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>â€™th
      marginal variance, <inline-formula><alternatives><tex-math><![CDATA[\sigma_i^2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>,
      is a weighted sum of the reciprocals of the eigenvalues of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      where the weights are the squares of the
      <inline-formula><alternatives><tex-math><![CDATA[i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>â€™th
      value in each eigenvector. This means that we can calculate the
      marginal standard deviations by iterating over the eigenvalues and
      -vectors of <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      and cumulating their values according to the formula above, then
      taking the element-wise square roots.</p>
          </sec>
          <sec id="step-3-scaling-the-eigendecomposition-nb-article">
            <title>Step 3: Scaling the Eigendecomposition</title>
            <p>To scale the eigendecomposition of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      using the marginal standard deviations, we define a diagonal
      matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{D}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğƒ</mml:mi></mml:math></alternatives></inline-formula>,
      where <inline-formula><alternatives><tex-math><![CDATA[D_{ii} = \sigma_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      and scale the precision matrix as:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \begin{aligned}
      \mathbf{\widetilde  Q} &= \mathbf{D}\mathbf{Q}^{\nu+1}\mathbf{D} \\
      &= \mathbf{D}\mathbf{V}\mathbf{\Lambda}^{\nu+1}\mathbf{V}^T\mathbf{D} \\
      &= \mathbf{\widetilde V}\mathbf{\widetilde\Lambda}\mathbf{\widetilde V}^T.
      \end{aligned}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right">
                          <mml:mover>
                            <mml:mi>ğ</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                        </mml:mtd>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:mi>ğƒ</mml:mi>
                          <mml:msup>
                            <mml:mi>ğ</mml:mi>
                            <mml:mrow>
                              <mml:mi>Î½</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mi>ğƒ</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right"/>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:mi>ğƒ</mml:mi>
                          <mml:mi>ğ•</mml:mi>
                          <mml:msup>
                            <mml:mi>ğš²</mml:mi>
                            <mml:mrow>
                              <mml:mi>Î½</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:msup>
                            <mml:mi>ğ•</mml:mi>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>ğƒ</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right"/>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:mover>
                            <mml:mi>ğ•</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                          <mml:mover>
                            <mml:mi>ğš²</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                          <mml:msup>
                            <mml:mover>
                              <mml:mi>ğ•</mml:mi>
                              <mml:mo accent="true">Ìƒ</mml:mo>
                            </mml:mover>
                            <mml:mi>T</mml:mi>
                          </mml:msup>
                          <mml:mi>.</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>In practice, we donâ€™t scale the whole eigendecomposition.
      Instead, we rescale each value/vector pair individually as we
      iterate over the eigenvectors and values of
      <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      to create the corresponding values and vectors for the larger
      matrix.</p>
          </sec>
          <sec id="step-4-efficient-computation-of-log-density-nb-article">
            <title>Step 4: Efficient Computation of Log-Density</title>
            <p>Using this scaled eigendecomposition, we efficiently
      compute:</p>
            <list list-type="order">
              <list-item>
                <p>Log-determinant: <inline-formula><alternatives><tex-math><![CDATA[\log|\mathbf{\widetilde Q}| = \sum_{i,j} \log(\widetilde\lambda_{ij})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>ğ</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[\widetilde\lambda_{ij}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
          is <inline-formula><alternatives><tex-math><![CDATA[\left( \left\{\lambda_{\rho_1}\right\}_i + \left\{\lambda_{\rho_2}\right\}_j \right)^{\nu+1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
          after rescaling with marginal standard deviations.</p>
              </list-item>
              <list-item>
                <p>Quadratic form: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z}^T\mathbf{\widetilde Q}\mathbf{z} = \sum_{i,j} (\widetilde\lambda_{ij}) y_{ij}^2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mover><mml:mi>ğ</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[y_{ij} = \left(\left\{\mathbf{v}_{\rho_1}\right\}_i \otimes \left\{\mathbf{v}_{\rho_2}\right\}_j\right)^T\mathbf{z}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ³</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
              </list-item>
            </list>
            <p>This approach allows us to calculate the density of the spatial
      copula by calculating and iterating over the spectral
      decomposition of the smaller matrices, avoiding the formation of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      alltogether.</p>
          </sec>
        </sec>
        <sec id="circulant-and-folded-circulant-approximations-nb-article">
          <title>Circulant and Folded Circulant Approximations</title>
          <p>While the eigendecomposition method provides an exact solution,
    it can be computationally expensive for very large spatial fields.
    To address this, we introduce circulant and folded circulant
    approximations that offer potential computational advantages.</p>
          <sec id="circulant-matrices-nb-article">
            <title>Circulant Matrices</title>
            <p>A circulant matrix <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
      is a special kind of matrix where each row is a cyclic shift of
      the row above it. It can be fully specified by its first row or
      column, called the base <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      C = \begin{pmatrix}
      c_0 & c_1 & c_2 & \cdots & c_{n-1} \\
      c_{n-1} & c_0 & c_1 & \cdots & c_{n-2} \\
      c_{n-2} & c_{n-1} & c_0 & \cdots & c_{n-3} \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      c_1 & c_2 & c_3 & \cdots & c_0
      \end{pmatrix} = (c_{j-i \mod n})
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>3</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>3</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>c</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>c</mml:mi>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>âˆ’</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mrow>
                              <mml:mspace width="0.444em"/>
                              <mml:mo>mod</mml:mo>
                              <mml:mspace width="0.222em"/>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>The base vector <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
      completely determines the circulant matrix and plays a crucial
      role in efficient computations. In particular:</p>
            <list list-type="order">
              <list-item>
                <p>The eigenvalues of <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          are given by the Discrete Fourier Transform (DFT) of
          <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>:
          <disp-formula><alternatives><tex-math><![CDATA[
          \lambda = \text{DFT}(c)
          ]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block"><mml:mrow><mml:mi>Î»</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">DFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
              </list-item>
              <list-item>
                <p>Matrix-vector multiplication can be performed using the
          FFT: <disp-formula><alternatives><tex-math><![CDATA[
          Cv = \text{DFT}(\text{DFT}(c) \odot \text{IDFT}(v))
          ]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block"><mml:mrow><mml:mi>C</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">DFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="normal">DFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âŠ™</mml:mo><mml:mtext mathvariant="normal">IDFT</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
              </list-item>
              <list-item>
                <p>When <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          is non singular, then the inverse is circulant and thus
          determined by its base:</p>
              </list-item>
            </list>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \frac1n \text{IDFT}(\text{DFT}(c)^{-1}).
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mi>n</mml:mi>
                      </mml:mfrac>
                      <mml:mtext mathvariant="normal">IDFT</mml:mtext>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mtext mathvariant="normal">DFT</mml:mtext>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mi>c</mml:mi>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>âˆ’</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>.</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>These properties allow for much faster computations than for
      general matrices.</p>
          </sec>
          <sec id="block-circulant-matrices-nb-article">
            <title>Block Circulant Matrices</title>
            <p>For two-dimensional spatial fields, we use block circulant
      matrices with circulant blocks (BCCB). An
      <inline-formula><alternatives><tex-math><![CDATA[Nn \times Nn]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>N</mml:mi><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      matrix C is block circulant if it has the form:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      C = \begin{pmatrix}
      C_0 & C_1 & C_2 & \cdots & C_{N-1} \\
      C_{N-1} & C_0 & C_1 & \cdots & C_{N-2} \\
      C_{N-2} & C_{N-1} & C_0 & \cdots & C_{N-3} \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      C_1 & C_2 & C_3 & \cdots & C_0
      \end{pmatrix} = (C_{j-i \mod N})
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mrow>
                                  <mml:mi>N</mml:mi>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>3</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>3</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mi>C</mml:mi>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>âˆ’</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mrow>
                              <mml:mspace width="0.444em"/>
                              <mml:mo>mod</mml:mo>
                              <mml:mspace width="0.222em"/>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where each <inline-formula><alternatives><tex-math><![CDATA[C_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is itself a circulant <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      matrix.</p>
            <p>For a BCCB matrix, we define a base matrix
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>,
      which is an <inline-formula><alternatives><tex-math><![CDATA[n \times N]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      matrix where each column is the base vector of the corresponding
      circulant block. This base matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      completely determines the BCCB matrix and is central to efficient
      computations:</p>
            <list list-type="order">
              <list-item>
                <p>The eigenvalues of <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          are given by the 2D DFT of <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>.</p>
              </list-item>
              <list-item>
                <p>Matrix-vector multiplication can be performed using the 2D
          FFT.</p>
              </list-item>
              <list-item>
                <p>When <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
          is non singular, then the inverse is also a BCCB matrix and
          thus determined by its base matrix.</p>
              </list-item>
            </list>
          </sec>
          <sec id="approximations-for-q_rho-nb-article">
            <title>Approximations for <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula></title>
            <p>Let <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      be the precision matrix of a one-dimensional AR(1) process with
      correlation <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>.
      The exact form of <inline-formula><alternatives><tex-math><![CDATA[Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{Q}_\rho = \frac{1}{1-\rho^2}
      \begin{bmatrix}
      1 & -\rho & 0 & \cdots & 0 \\
      -\rho & 1+\rho^2 & -\rho & \cdots & 0 \\
      0 & -\rho & 1+\rho^2 & \cdots & 0 \\
      \vdots & \vdots & \vdots & \ddots & \vdots \\
      0 & 0 & 0 & \cdots & 1
      \end{bmatrix}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:mi>Ï</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>âˆ’</mml:mo>
                          <mml:msup>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:mi>Ï</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <sec id="circulant-approximation-nb-article">
              <title>Circulant Approximation</title>
              <p>The circulant approximation to <inline-formula><alternatives><tex-math><![CDATA[Q_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
        denoted as <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho^{(circ)}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>,
        is:</p>
              <p>
                <disp-formula>
                  <alternatives>
                    <tex-math><![CDATA[
        \mathbf{Q}_\rho^{(circ)} = \frac{1}{1-\rho^2}
        \begin{bmatrix}
        1+\rho^2 & -\rho & 0 & \cdots & 0 & -\rho \\
        -\rho & 1+\rho^2 & -\rho & \cdots & 0 & 0 \\
        0 & -\rho & 1+\rho^2 & \cdots & 0 & 0 \\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
        -\rho & 0 & 0 & \cdots & -\rho & 1+\rho^2
        \end{bmatrix}
        ]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>ğ</mml:mi>
                          <mml:mi>Ï</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mi>c</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:mi>r</mml:mi>
                            <mml:mi>c</mml:mi>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>âˆ’</mml:mo>
                            <mml:msup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">[</mml:mo>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mo>â‹±</mml:mo>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                          <mml:mo stretchy="true" form="postfix">]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </disp-formula>
              </p>
              <p>This approximation treats the first and last observations as
        neighbors, effectively wrapping the data around a circle.</p>
            </sec>
            <sec id="folded-circulant-approximation-nb-article">
              <title>Folded Circulant Approximation</title>
              <p>The folded circulant approximation,
        <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_\rho^{(fold)}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msubsup><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>,
        is based on a reflected version of the data. We double the data
        by reflecting it, giving us the data
        <inline-formula><alternatives><tex-math><![CDATA[x_1,  \dots, x_n, x_n, \dots, x_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
        We then model this doubled data with a
        <inline-formula><alternatives><tex-math><![CDATA[2n \times 2n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
        circulant matrix. If written out as an
        <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
        matrix, it takes the form:</p>
              <p>
                <disp-formula>
                  <alternatives>
                    <tex-math><![CDATA[
        \mathbf{Q}_\rho^{(fold)} = \frac{1}{1-\rho^2}
        \begin{bmatrix}
        1-\rho+\rho^2 & -\rho & 0 & \cdots & 0 & 0 \\
        -\rho & 1+\rho^2 & -\rho & \cdots & 0 & 0 \\
        0 & -\rho & 1+\rho^2 & \cdots & 0 & 0 \\
        \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & 0 & \cdots & -\rho & 1-\rho+\rho^2
        \end{bmatrix}
        ]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>ğ</mml:mi>
                          <mml:mi>Ï</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mi>f</mml:mi>
                            <mml:mi>o</mml:mi>
                            <mml:mi>l</mml:mi>
                            <mml:mi>d</mml:mi>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>=</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>âˆ’</mml:mo>
                            <mml:msup>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">[</mml:mo>
                          <mml:mtable>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mi>Ï</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mo>â‹±</mml:mo>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹®</mml:mi>
                              </mml:mtd>
                            </mml:mtr>
                            <mml:mtr>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>0</mml:mn>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>â‹¯</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mi>âˆ’</mml:mi>
                                <mml:mi>Ï</mml:mi>
                              </mml:mtd>
                              <mml:mtd columnalign="center" style="text-align: center">
                                <mml:mn>1</mml:mn>
                                <mml:mo>âˆ’</mml:mo>
                                <mml:mi>Ï</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mtd>
                            </mml:mtr>
                          </mml:mtable>
                          <mml:mo stretchy="true" form="postfix">]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </disp-formula>
              </p>
              <p>This approximation modifies the first and last diagonal
        elements to account for the reflection of the data. As
        <inline-formula><alternatives><tex-math><![CDATA[x_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        now is the first and last data point, then we avoid the circular
        dependence from the regular circulant approximation.</p>
            </sec>
          </sec>
          <sec id="extension-to-the-full-q-matrix-nb-article">
            <title>Extension to the Full Q Matrix</title>
            <p>For a two-dimensional spatial field on an
      <inline-formula><alternatives><tex-math><![CDATA[n_1 \times n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      grid, we construct the full precision matrix Q using a Kronecker
      sum:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{Q} = \left( \mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2} \right)^{(\nu + 1)}, \quad \nu \in \{0, 1, 2\}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:msub>
                            <mml:mi>ğ</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo>âŠ—</mml:mo>
                          <mml:msub>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ§</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ§</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo>âŠ—</mml:mo>
                          <mml:msub>
                            <mml:mi>ğ</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>Î½</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="1.0em"/>
                      <mml:mi>Î½</mml:mi>
                      <mml:mo>âˆˆ</mml:mo>
                      <mml:mo stretchy="false" form="prefix">{</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo stretchy="false" form="postfix">}</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
      denotes the Kronecker product, <inline-formula><alternatives><tex-math><![CDATA[I_n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is the <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      identity matrix, and <inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>
      is a smoothness parameter.</p>
            <p>When we approximate <inline-formula><alternatives><tex-math><![CDATA[Q_\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      with a circulant matrix, this Kronecker sum results in a
      block-circulant matrix with circulant blocks (BCCB). To see this,
      letâ€™s consider the case where <inline-formula><alternatives><tex-math><![CDATA[\nu = 0]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
      for simplicity:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{Q} = \mathbf{Q}_{\rho_1} \otimes \mathbf{I_{n_2}} + \mathbf{I_{n_1}} \otimes \mathbf{Q}_{\rho_2}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:msub>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ§</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ§</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:msub>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:msub>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>Now, let the two AR(1) matrices be approximated by a circulant
      matrix <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
      with base vector <inline-formula><alternatives><tex-math><![CDATA[c = [c_, c_1, ..., c_{n-1}]]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mo>,</mml:mo></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
      Then:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{Q}_{\rho_1} \approx \mathbf{C_{\rho_1}} = \frac{1}{1-\rho_1^2}
      \begin{bmatrix}
      1+\rho_1^2 & -\rho_1 & 0 & \cdots & 0 & -\rho_1 \\
      -\rho_1 & 1+\rho_1^2 & -\rho_1 & \cdots & 0 & 0 \\
      0 & -\rho_1 & 1+\rho_1^2 & \cdots & 0 & 0 \\
      \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
      -\rho_1 & 0 & 0 & \cdots & -\rho_1 & 1+\rho_1^2
      \end{bmatrix},
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:msub>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>â‰ˆ</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ‚</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ›’</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>âˆ’</mml:mo>
                          <mml:msubsup>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>1</mml:mn>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>and <inline-formula><alternatives><tex-math><![CDATA[C_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
      is defined similarly. The Kronecker product
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf C_{\rho_1} \otimes \mathbf I_{n_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğ‚</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>ğˆ</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      results in a block matrix where each block is a scalar multiple of
      <inline-formula><alternatives><tex-math><![CDATA[I_{n_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{C_{\rho_1}} \otimes \mathbf{I_{n_2}} = \frac{1}{1-\rho_1^2}
      \begin{pmatrix}
      (1+\rho_1^2)\mathbf{I_{n_2}} & -\rho_1\mathbf{I_{n_2}} & \dots & \cdots & -\rho_1\mathbf{I_{n_2}} \\
      -\rho_1\mathbf{I_{n_2}} & (1+\rho_1^2)\mathbf{I_{n_2}} & -\rho_1 \mathbf{I_{n_2}} & \cdots & \vdots  \\
      \vdots & \ddots & \ddots & \ddots & \vdots \\
      \vdots & \ddots & -\rho_1\mathbf{I_{n_2}} & (1+\rho_1^2)\mathbf{I_{n_2}} & -\rho_1 \mathbf{I_{n_2}}  \\
      -\rho_1\mathbf{I_{n_2}} & \dots & \cdots & -\rho_1 \mathbf{I_{n_2}} & (1+\rho_1^2)\mathbf{I_{n_2}}
      \end{pmatrix}.
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>ğ‚</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ›’</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ§</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>âˆ’</mml:mo>
                          <mml:msubsup>
                            <mml:mi>Ï</mml:mi>
                            <mml:mn>1</mml:mn>
                            <mml:mn>2</mml:mn>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â€¦</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â€¦</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>Ï</mml:mi>
                                  <mml:mn>1</mml:mn>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                                <mml:mo stretchy="true" form="postfix">)</mml:mo>
                              </mml:mrow>
                              <mml:msub>
                                <mml:mi>ğˆ</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ§</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>.</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>Similarly, <inline-formula><alternatives><tex-math><![CDATA[\mathbf I_{n_1} \otimes \mathbf C_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğˆ</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>ğ‚</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      results in a block diagonal matrix where each block is a copy of
      <inline-formula><alternatives><tex-math><![CDATA[C_{\rho_2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>C</mml:mi><mml:msub><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula>:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{I_{n_1}} \otimes \mathbf{C_{\rho_2}} = 
      \begin{pmatrix}
      \mathbf{C_{\rho_2}} & \mathbf{0} & \cdots & \mathbf{0} \\
      \mathbf{0} & \mathbf{C_{\rho_2}} & \cdots & \mathbf{0} \\
      \vdots & \vdots & \ddots & \vdots \\
      \mathbf{0} & \mathbf{0} & \cdots & \mathbf{C_{\rho_2}}
      \end{pmatrix}.
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ§</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ‚</mml:mi>
                        <mml:msub>
                          <mml:mi>ğ›’</mml:mi>
                          <mml:mn>ğŸ</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ‚</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ›’</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>ğŸ</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>ğŸ</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>ğŸ</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ‚</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ›’</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>ğŸ</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>ğŸ</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>ğŸ</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ‚</mml:mi>
                                <mml:msub>
                                  <mml:mi>ğ›’</mml:mi>
                                  <mml:mn>ğŸ</mml:mn>
                                </mml:msub>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>.</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>The sum of these two matrices is a block-circulant matrix with
      circulant blocks:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{Q} \approx \mathbf C_{\rho_1} \otimes \mathbf I_{n_2} + \mathbf I_{n_1} \otimes \mathbf C_{\rho_2} = 
      \begin{pmatrix}
      \mathbf{B}_0 & \mathbf{B}_1 & \cdots & \mathbf{B}_{n_1-1} \\
      \mathbf{B}_{n_1-1} & \mathbf{B}_0 & \cdots & \mathbf{B}_{n_1-2} \\
      \vdots & \vdots & \ddots & \vdots \\
      \mathbf{B}_1 & \mathbf{B}_2 & \cdots & \mathbf{B}_0
      \end{pmatrix}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo>â‰ˆ</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ‚</mml:mi>
                        <mml:msub>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ‚</mml:mi>
                        <mml:msub>
                          <mml:mi>Ï</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>n</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>n</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>n</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:msub>
                                <mml:mi>ğ</mml:mi>
                                <mml:mn>0</mml:mn>
                              </mml:msub>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where each <inline-formula><alternatives><tex-math><![CDATA[\mathbf{B_i}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>ğ¢</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is a circulant matrix. Specifically,</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \begin{aligned}
      \mathbf{B_0} &= \frac{(1+\rho_1^2)}{(1 - \rho_1^2)}\mathbf{I_{n_2}} + \mathbf C_{\rho_2}, \quad \text{and} \\
      \mathbf{B_1} &= \mathbf{B_{n_1 - 1}} = \frac{-\rho_1}{(1 - \rho_1^2)}\mathbf{I_{n_2}}.
      \end{aligned}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right">
                          <mml:msub>
                            <mml:mi>ğ</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>+</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>âˆ’</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:msub>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ§</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mi>ğ‚</mml:mi>
                            <mml:msub>
                              <mml:mi>Ï</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:mspace width="1.0em"/>
                          <mml:mtext mathvariant="normal">and</mml:mtext>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="right" style="text-align: right">
                          <mml:msub>
                            <mml:mi>ğ</mml:mi>
                            <mml:mn>ğŸ</mml:mn>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="left" style="text-align: left">
                          <mml:mo>=</mml:mo>
                          <mml:msub>
                            <mml:mi>ğ</mml:mi>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>ğ§</mml:mi>
                                <mml:mn>ğŸ</mml:mn>
                              </mml:msub>
                              <mml:mo mathvariant="bold">âˆ’</mml:mo>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mi>âˆ’</mml:mi>
                              <mml:msub>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>âˆ’</mml:mo>
                              <mml:msubsup>
                                <mml:mi>Ï</mml:mi>
                                <mml:mn>1</mml:mn>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                          </mml:mfrac>
                          <mml:msub>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:msub>
                              <mml:mi>ğ§</mml:mi>
                              <mml:mn>ğŸ</mml:mn>
                            </mml:msub>
                          </mml:msub>
                          <mml:mi>.</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>This BCCB structure allows us to use 2D FFT for efficient
      computations. The base matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      for this BCCB structure is:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{c} = \begin{bmatrix}
      \frac{(1+\rho_1^2)}{(1 - \rho_1^2)} + \frac{(1+\rho_2^2)}{(1 - \rho_2^2)} & \frac{-\rho_1}{(1 - \rho_1^2)} & 0 & \cdots  & \frac{-\rho_1}{(1 - \rho_1^2)} \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0 \\
      0 & 0 & 0 & \cdots  & 0 \\
      \vdots & \vdots & \vdots & \ddots &  \vdots \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0
      \end{bmatrix}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğœ</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                              <mml:mo>+</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>This base matrix <inline-formula><alternatives><tex-math><![CDATA[c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
      captures the structure of the precision matrix
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      and allows for efficient computation of eigenvalues using the 2D
      Fast Fourier Transform (FFT), enabling rapid calculation of the
      log-determinant and quadratic forms needed for the Gaussian copula
      density.</p>
          </sec>
        </sec>
        <sec id="computation-with-circulant-approximation-nb-article">
          <title>Computation with Circulant Approximation</title>
          <p>When using the circulant approximation, we leverage the efficient
    computation properties of block circulant matrices with circulant
    blocks (BCCB). This approach significantly reduces the computational
    complexity, especially for large spatial fields. Hereâ€™s the
    step-by-step process:</p>
          <sec id="construct-the-base-matrix-nb-article">
            <title>1. Construct the Base Matrix</title>
            <p>First, we construct the base matrix
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      for our BCCB approximation of <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>.
      For an <inline-formula><alternatives><tex-math><![CDATA[n_1 \times n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      grid, <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>
      is an <inline-formula><alternatives><tex-math><![CDATA[n_2 \times n_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      matrix:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \mathbf{c} = \begin{bmatrix}
      \frac{(1+\rho_1^2)}{(1 - \rho_1^2)} + \frac{(1+\rho_2^2)}{(1 - \rho_2^2)} & \frac{-\rho_1}{(1 - \rho_1^2)} & 0 & \cdots  & \frac{-\rho_1}{(1 - \rho_1^2)} \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0 \\
      0 & 0 & 0 & \cdots  & 0 \\
      \vdots & \vdots & \vdots & \ddots &  \vdots \\
      \frac{-\rho_2}{(1 - \rho_2^2)} & 0 & 0 & \cdots  & 0
      \end{bmatrix}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğœ</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">[</mml:mo>
                        <mml:mtable>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                              <mml:mo>+</mml:mo>
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>1</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mo>â‹±</mml:mo>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹®</mml:mi>
                            </mml:mtd>
                          </mml:mtr>
                          <mml:mtr>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mfrac>
                                <mml:mrow>
                                  <mml:mi>âˆ’</mml:mi>
                                  <mml:msub>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>âˆ’</mml:mo>
                                  <mml:msubsup>
                                    <mml:mi>Ï</mml:mi>
                                    <mml:mn>2</mml:mn>
                                    <mml:mn>2</mml:mn>
                                  </mml:msubsup>
                                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                                </mml:mrow>
                              </mml:mfrac>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mi>â‹¯</mml:mi>
                            </mml:mtd>
                            <mml:mtd columnalign="center" style="text-align: center">
                              <mml:mn>0</mml:mn>
                            </mml:mtd>
                          </mml:mtr>
                        </mml:mtable>
                        <mml:mo stretchy="true" form="postfix">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>This base matrix encapsulates the structure of our MatÃ©rn-like
      precision matrix.</p>
          </sec>
          <sec id="compute-initial-eigenvalues-nb-article">
            <title>2. Compute Initial Eigenvalues</title>
            <p>We compute the initial eigenvalues of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      using the 2D Fast Fourier Transform (FFT) of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf c]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğœ</mml:mi></mml:math></alternatives></inline-formula>:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \boldsymbol{\Lambda} = \text{FFT2}(\mathbf{c})^{\nu+1}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mi>ğš²</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mtext mathvariant="normal">FFT2</mml:mtext>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>ğœ</mml:mi>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>Î½</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where Î½ is the smoothness parameter.</p>
          </sec>
          <sec id="compute-marginal-variance-and-rescale-eigenvalues-nb-article">
            <title>3. Compute Marginal Variance and Rescale
      Eigenvalues</title>
            <p>An important property of Block Circulant with Circulant Blocks
      (BCCB) matrices is that the inverse of a BCCB matrix is also a
      BCCB matrix, and the marginal variance is the first element in its
      first circulant block. We use this to efficiently compute the
      marginal variance and rescale the eigenvalues:</p>
            <list list-type="alpha-lower">
              <list-item>
                <p>Compute the element-wise inverse of
          <inline-formula><alternatives><tex-math><![CDATA[\boldsymbol{\Lambda}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğš²</mml:mi></mml:math></alternatives></inline-formula>:
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Lambda^{inv}} = 1 / \boldsymbol{\Lambda}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğš²</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>ğš²</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute the base of <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
          using inverse 2D FFT: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{c_{inv}} = \text{IFFT2}(\mathbf{{\Lambda^{inv}}})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğœ</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">IFFT2</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>ğš²</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>The marginal variance is given by the first element of
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{c^{inv}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>ğœ</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>:
          <inline-formula><alternatives><tex-math><![CDATA[\sigma^2 = \mathbf{c^{inv}}_{(0,0)}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>Ïƒ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:msup><mml:mi>ğœ</mml:mi><mml:mrow><mml:mi>ğ¢</mml:mi><mml:mi>ğ§</mml:mi><mml:mi>ğ¯</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Rescale the eigenvalues: <inline-formula><alternatives><tex-math><![CDATA[\boldsymbol{\widetilde \Lambda} = \sigma^2 \boldsymbol{\Lambda}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mover><mml:mi>ğš²</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi>Ïƒ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ğš²</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
            </list>
            <p>This process ensures that the resulting precision matrix will
      have unit marginal variances, as required for the Gaussian
      copula.</p>
          </sec>
          <sec id="compute-log-determinant-nb-article">
            <title>4. Compute Log-Determinant</title>
            <p>The log-determinant of the scaled
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\widetilde Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mover><mml:mi>ğ</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
      can be efficiently calculated as the sum of the logarithms of the
      scaled eigenvalues:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \log|\mathbf{Q}| = \sum_{i,j} \log(\widetilde \Lambda_{ij})
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">|</mml:mo>
                        <mml:mi>ğ</mml:mi>
                        <mml:mo stretchy="true" form="postfix">|</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:munder>
                        <mml:mo>âˆ‘</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:msub>
                          <mml:mover>
                            <mml:mi>Î›</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
          </sec>
          <sec id="compute-quadratic-form-nb-article">
            <title>5. Compute Quadratic Form</title>
            <p>To compute the quadratic form <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z}^T\mathbf{Q}\mathbf{z}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ</mml:mi><mml:mi>ğ³</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
      we use the following steps:</p>
            <list list-type="alpha-lower">
              <list-item>
                <p>Compute the 2D FFT of z: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\hat{z}} = \text{FFT2}(\mathbf{z})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mover><mml:mi>ğ³</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">FFT2</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ³</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Multiply element-wise with the scaled eigenvalues:
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\hat{y}} = \boldsymbol{\widetilde \Lambda} \odot \mathbf{\hat{z}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mover><mml:mi>ğ²</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover><mml:mi>ğš²</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo>âŠ™</mml:mo><mml:mover><mml:mi>ğ³</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute the inverse 2D FFT: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{y} = \text{IFFT2}(\mathbf{\hat{y}})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ²</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">IFFT2</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mover><mml:mi>ğ²</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
              <list-item>
                <p>Compute the dot product: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z}^T\mathbf{Q}\mathbf{z} = \mathbf{z}^T\mathbf{y}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ</mml:mi><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ²</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
              </list-item>
            </list>
          </sec>
          <sec id="compute-the-log-density-nb-article">
            <title>6. Compute the Log-Density</title>
            <p>Finally, we can compute the log-density of the Gaussian
      copula:</p>
            <p>
              <disp-formula>
                <alternatives>
                  <tex-math><![CDATA[
      \log c(\mathbf{u}) = \frac{1}{2}\log|\mathbf{Q}| - \frac{1}{2}\mathbf{z}^T\mathbf{Q}\mathbf{z} + \frac{1}{2}\mathbf{z}^T\mathbf{z}
      ]]></tex-math>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                    <mml:mrow>
                      <mml:mo>log</mml:mo>
                      <mml:mi>c</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>ğ®</mml:mi>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mn>2</mml:mn>
                      </mml:mfrac>
                      <mml:mo>log</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">|</mml:mo>
                        <mml:mi>ğ</mml:mi>
                        <mml:mo stretchy="true" form="postfix">|</mml:mo>
                      </mml:mrow>
                      <mml:mo>âˆ’</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mn>2</mml:mn>
                      </mml:mfrac>
                      <mml:msup>
                        <mml:mi>ğ³</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:msup>
                      <mml:mi>ğ</mml:mi>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:mn>1</mml:mn>
                        <mml:mn>2</mml:mn>
                      </mml:mfrac>
                      <mml:msup>
                        <mml:mi>ğ³</mml:mi>
                        <mml:mi>T</mml:mi>
                      </mml:msup>
                      <mml:mi>ğ³</mml:mi>
                    </mml:mrow>
                  </mml:math>
                </alternatives>
              </disp-formula>
            </p>
            <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z} = \Phi^{-1}(\mathbf{u})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
          </sec>
        </sec>
        <sec id="computation-with-folded-circulant-approximation-nb-article">
          <title>Computation with Folded Circulant Approximation</title>
          <p>The folded circulant approximation offers an alternative approach
    that can provide better accuracy near the edges of the spatial
    field. This method is based on the idea of reflecting the data along
    each coordinate axis, effectively doubling the size of the field.
    Other than that, the algorithmic implementation is the same except
    that the circulant approximation matrices to
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf Q_{\rho}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mi>Ï</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    are now <inline-formula><alternatives><tex-math><![CDATA[2n \times 2n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
          <p>First, we reflect the data along each coordinate axis. For a 2D
    spatial field represented by an <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    matrix, the reflected data takes the form:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
    \begin{bmatrix}
    x_{11} & \cdots & x_{1n_2} & x_{1n_2} & \cdots & x_{11} \\
    \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
    x_{n_11} & \cdots & x_{n_1n_2} & x_{n_1n_2} & \cdots & x_{n_11} \\
    x_{n_11} & \cdots & x_{n_1n_2} & x_{n_1n_2} & \cdots & x_{n_11} \\
    \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
    x_{11} & \cdots & x_{1n_2} & x_{1n_2} & \cdots & x_{11}
    \end{bmatrix}
    ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">[</mml:mo>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mo>â‹±</mml:mo>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mo>â‹±</mml:mo>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>11</mml:mn>
                            </mml:msub>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>11</mml:mn>
                            </mml:msub>
                          </mml:msub>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>11</mml:mn>
                            </mml:msub>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mn>11</mml:mn>
                            </mml:msub>
                          </mml:msub>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mo>â‹±</mml:mo>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mo>â‹±</mml:mo>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹®</mml:mi>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:msub>
                                <mml:mi>n</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:mi>â‹¯</mml:mi>
                        </mml:mtd>
                        <mml:mtd columnalign="center" style="text-align: center">
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mn>11</mml:mn>
                          </mml:msub>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mo stretchy="true" form="postfix">]</mml:mo>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>This reflection creates a <inline-formula><alternatives><tex-math><![CDATA[2n_1 \times 2n_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    matrix. The matrix is then stacked in lexicographic order before
    entering into the quadratic forms.</p>
        </sec>
      </sec>
      <sec id="results-nb-article">
        <title>Results</title>
        <sec id="computational-efficiency-nb-article">
          <title>Computational Efficiency</title>
          <p>Table 1 presents the results of a benchmark comparing the time it
    takes to evaluate the gaussian copula density described above. For
    each grid size, we report the computation time for the exact method
    and the two approximations, along with the speed-up factor relative
    to the exact method. Each calculation was performed twenty times and
    the median times are shown in the table. The Cholesky method is
    described in the appendix.</p>
          <sec specific-use="notebook-content">
            <code language="r script">read_csv("tables/benchmark_scaled.csv") |&gt; 
gt() |&gt; 
  cols_label(
    Grid = "Grid Size",
    eig = "Time",
    sp_1 = "Speed-up",
    circ = "Time",
    sp_2 = "Speed-Up",
    fol = "Time",
    sp_3 = "Speed-Up"
  ) |&gt; 
  tab_spanner(
    label = "Eigen",
    columns = 3:4
  ) |&gt; 
  tab_spanner(
    label = "Circulant",
    columns = 5:6
  ) |&gt; 
  tab_spanner(
    label = "Folded",
    columns = 7:8
  ) |&gt; 
  tab_caption(
    md("Benchmarking how long it takes to evaluate the density of a MÃ¡tern($\\nu$)-like field with correlation parameter $\\rho$ scaled to have unit marginal variance")
  )</code>
            <boxed-text>
              <preformat>Rows: 10 Columns: 8
â”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Delimiter: ","
chr (8): Grid, Cholesky, eig, sp_1, circ, sp_2, fol, sp_3

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
            </boxed-text>
            <table-wrap>
              <caption>
                <p>Benchmarking how long it takes to evaluate the density of a
        MÃ¡tern(<inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>)-like
        field with correlation parameter <inline-formula><alternatives><tex-math><![CDATA[\rho]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
        scaled to have unit marginal variance</p>
              </caption>
              <table>
                <thead>
                  <tr>
                    <th rowspan="2" id="GridU0020Size-nb-article" scope="col">Grid
            Size</th>
                    <th rowspan="2" id="Cholesky-nb-article" scope="col">Cholesky</th>
                    <th colspan="2" id="Eigen-nb-article" scope="colgroup">
                      <named-content content-type="gt_column_spanner">Eigen</named-content>
                    </th>
                    <th colspan="2" id="Circulant-nb-article" scope="colgroup">
                      <named-content content-type="gt_column_spanner">Circulant</named-content>
                    </th>
                    <th colspan="2" id="Folded-nb-article" scope="colgroup">
                      <named-content content-type="gt_column_spanner">Folded</named-content>
                    </th>
                  </tr>
                  <tr>
                    <th id="Time-nb-article" scope="col">Time</th>
                    <th id="Speed-up-nb-article" scope="col">Speed-up</th>
                    <th id="Time-nb-article" scope="col">Time</th>
                    <th id="Speed-Up-nb-article" scope="col">Speed-Up</th>
                    <th id="Time-nb-article" scope="col">Time</th>
                    <th id="Speed-Up-nb-article" scope="col">Speed-Up</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td headers="Grid">10x10</td>
                    <td headers="Cholesky">73.04Âµs</td>
                    <td headers="eig">173.43Âµs</td>
                    <td headers="sp_1">0.42x</td>
                    <td headers="circ">31.9Âµs</td>
                    <td headers="sp_2">2.29x</td>
                    <td headers="fol">44.16Âµs</td>
                    <td headers="sp_3">1.65x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">20x20</td>
                    <td headers="Cholesky">1.43ms</td>
                    <td headers="eig">267.01Âµs</td>
                    <td headers="sp_1">5.36x</td>
                    <td headers="circ">44Âµs</td>
                    <td headers="sp_2">32.54x</td>
                    <td headers="fol">151.74Âµs</td>
                    <td headers="sp_3">9.44x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">30x30</td>
                    <td headers="Cholesky">9.88ms</td>
                    <td headers="eig">808.5Âµs</td>
                    <td headers="sp_1">12.22x</td>
                    <td headers="circ">110.2Âµs</td>
                    <td headers="sp_2">89.63x</td>
                    <td headers="fol">243.07Âµs</td>
                    <td headers="sp_3">40.64x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">40x40</td>
                    <td headers="Cholesky">37.88ms</td>
                    <td headers="eig">2.06ms</td>
                    <td headers="sp_1">18.35x</td>
                    <td headers="circ">141.5Âµs</td>
                    <td headers="sp_2">267.64x</td>
                    <td headers="fol">393.79Âµs</td>
                    <td headers="sp_3">96.18x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">50x50</td>
                    <td headers="Cholesky">106.28ms</td>
                    <td headers="eig">4.56ms</td>
                    <td headers="sp_1">23.33x</td>
                    <td headers="circ">188.5Âµs</td>
                    <td headers="sp_2">563.82x</td>
                    <td headers="fol">604.87Âµs</td>
                    <td headers="sp_3">175.7x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">60x60</td>
                    <td headers="Cholesky">253.66ms</td>
                    <td headers="eig">8.79ms</td>
                    <td headers="sp_1">28.86x</td>
                    <td headers="circ">242.4Âµs</td>
                    <td headers="sp_2">1046.59x</td>
                    <td headers="fol">836.07Âµs</td>
                    <td headers="sp_3">303.4x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">70x70</td>
                    <td headers="Cholesky">538.42ms</td>
                    <td headers="eig">16.81ms</td>
                    <td headers="sp_1">32.04x</td>
                    <td headers="circ">333.1Âµs</td>
                    <td headers="sp_2">1616.37x</td>
                    <td headers="fol">1.17ms</td>
                    <td headers="sp_3">459.89x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">80x80</td>
                    <td headers="Cholesky">1.02s</td>
                    <td headers="eig">29.59ms</td>
                    <td headers="sp_1">34.63x</td>
                    <td headers="circ">393.9Âµs</td>
                    <td headers="sp_2">2601.89x</td>
                    <td headers="fol">1.59ms</td>
                    <td headers="sp_3">643.46x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">90x90</td>
                    <td headers="Cholesky">1.81s</td>
                    <td headers="eig">48.56ms</td>
                    <td headers="sp_1">37.27x</td>
                    <td headers="circ">598.9Âµs</td>
                    <td headers="sp_2">3022.23x</td>
                    <td headers="fol">2.04ms</td>
                    <td headers="sp_3">888.28x</td>
                  </tr>
                  <tr>
                    <td headers="Grid">100x100</td>
                    <td headers="Cholesky">3.09s</td>
                    <td headers="eig">76.03ms</td>
                    <td headers="sp_1">40.59x</td>
                    <td headers="circ">593Âµs</td>
                    <td headers="sp_2">5204.38x</td>
                    <td headers="fol">2.42ms</td>
                    <td headers="sp_3">1276.46x</td>
                  </tr>
                </tbody>
              </table>
            </table-wrap>
          </sec>
        </sec>
      </sec>
      <sec id="appendix-nb-article">
        <title>Appendix</title>
        <sec id="cholesky-methods-nb-article">
          <title>Cholesky Methods</title>
          <p>Standard methods of evaluating multivariate normal densities
    using the Cholesky decomposition were implemented to compare with
    the new methods for benchmarking.</p>
          <sec id="unscaled-precision-matrix-nb-article">
            <title>Unscaled Precision Matrix</title>
            <sec id="precision-matrix-construction-nb-article">
              <title>Precision Matrix Construction</title>
              <p>We start by constructing the precision matrix
        <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
        for a 2D MatÃ©rn field on a grid of size
        <inline-formula><alternatives><tex-math><![CDATA[d_x \times d_y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:</p>
              <p>
                <disp-formula>
                  <alternatives>
                    <tex-math><![CDATA[
        Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2 
        ]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                      <mml:mrow>
                        <mml:mi>Q</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mi>Q</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>I</mml:mi>
                          <mml:msub>
                            <mml:mi>d</mml:mi>
                            <mml:mi>y</mml:mi>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>I</mml:mi>
                          <mml:msub>
                            <mml:mi>d</mml:mi>
                            <mml:mi>x</mml:mi>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>Q</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </disp-formula>
              </p>
              <p>where <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
        denotes the Kronecker product, <inline-formula><alternatives><tex-math><![CDATA[Q_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        are 1D precision matrices for the x and y dimensions
        respectively (typically AR(1)-like structures), and
        <inline-formula><alternatives><tex-math><![CDATA[I_{d_x}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[I_{d_y}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        are identity matrices of appropriate sizes.</p>
            </sec>
            <sec id="density-computation-nb-article">
              <title>Density Computation</title>
              <p>For a MatÃ©rn field with smoothness parameter
        <inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>,
        we need to work with <inline-formula><alternatives><tex-math><![CDATA[Q^{\nu+1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.
        We can efficiently compute the log-determinant,
        <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
        and the quadratic form, <inline-formula><alternatives><tex-math><![CDATA[x^T Q^{\nu+1} x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
        without explicitly forming <inline-formula><alternatives><tex-math><![CDATA[Q^{\nu+1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.
        To do this, we compute the Cholesky decomposition,
        <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>,
        where L is a lower triangular matrix, and make use of the
        following equations:</p>
              <p>
                <disp-formula>
                  <alternatives>
                    <tex-math><![CDATA[
        \log|Q^{\nu+1}| = (\nu+1)\log|Q| = 2(\nu+1)\sum_{i}\log(L_{ii}), 
        ]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                      <mml:mrow>
                        <mml:mo>log</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">|</mml:mo>
                          <mml:msup>
                            <mml:mi>Q</mml:mi>
                            <mml:mrow>
                              <mml:mi>Î½</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo stretchy="true" form="postfix">|</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>Î½</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mo>log</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">|</mml:mo>
                          <mml:mi>Q</mml:mi>
                          <mml:mo stretchy="true" form="postfix">|</mml:mo>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>Î½</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:munder>
                          <mml:mo>âˆ‘</mml:mo>
                          <mml:mi>i</mml:mi>
                        </mml:munder>
                        <mml:mo>log</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:msub>
                            <mml:mi>L</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </disp-formula>
              </p>
              <p>
                <disp-formula>
                  <alternatives>
                    <tex-math><![CDATA[
        \begin{aligned}
        x^T Q x &= x^T L L^T x = ||L^T x||_2^2 \\
        x^T Q^2 x &=  x^T L L^T L L^T x = ||LL^T x||_2^2 \\
        x^T Q^3 x &=  x^T L L^T L L^T L L^T x = ||L^TLL^T x||_2^2.
        \end{aligned}
        ]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd columnalign="right" style="text-align: right">
                            <mml:msup>
                              <mml:mi>x</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>Q</mml:mi>
                            <mml:mi>x</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="left" style="text-align: left">
                            <mml:mo>=</mml:mo>
                            <mml:msup>
                              <mml:mi>x</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">|</mml:mo>
                              <mml:mo stretchy="true" form="postfix">|</mml:mo>
                            </mml:mrow>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">|</mml:mo>
                                <mml:mo stretchy="true" form="postfix">|</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="right" style="text-align: right">
                            <mml:msup>
                              <mml:mi>x</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:msup>
                              <mml:mi>Q</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="left" style="text-align: left">
                            <mml:mo>=</mml:mo>
                            <mml:msup>
                              <mml:mi>x</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">|</mml:mo>
                              <mml:mo stretchy="true" form="postfix">|</mml:mo>
                            </mml:mrow>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">|</mml:mo>
                                <mml:mo stretchy="true" form="postfix">|</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd columnalign="right" style="text-align: right">
                            <mml:msup>
                              <mml:mi>x</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:msup>
                              <mml:mi>Q</mml:mi>
                              <mml:mn>3</mml:mn>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                          </mml:mtd>
                          <mml:mtd columnalign="left" style="text-align: left">
                            <mml:mo>=</mml:mo>
                            <mml:msup>
                              <mml:mi>x</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">|</mml:mo>
                              <mml:mo stretchy="true" form="postfix">|</mml:mo>
                            </mml:mrow>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>L</mml:mi>
                            <mml:msup>
                              <mml:mi>L</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msup>
                            <mml:mi>x</mml:mi>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mo stretchy="true" form="prefix">|</mml:mo>
                                <mml:mo stretchy="true" form="postfix">|</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                            <mml:mi>.</mml:mi>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                    </mml:math>
                  </alternatives>
                </disp-formula>
              </p>
            </sec>
            <sec id="algorithm-nb-article">
              <title>Algorithm</title>
              <list list-type="order">
                <list-item>
                  <p>Construct <inline-formula><alternatives><tex-math><![CDATA[Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Compute Cholesky decomposition
            <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Compute log-determinant: <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}| = 2(\nu+1)\sum_{i}\log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>For each observation <inline-formula><alternatives><tex-math><![CDATA[x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>:</p>
                  <list list-type="roman-lower">
                    <list-item>
                      <label>i)</label>
                      <p>Initialize <inline-formula><alternatives><tex-math><![CDATA[y = x]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                    </list-item>
                    <list-item>
                      <label>ii)</label>
                      <p>For <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
                from 0 to <inline-formula><alternatives><tex-math><![CDATA[\nu]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Î½</mml:mi></mml:math></alternatives></inline-formula>:</p>
                      <list list-type="bullet">
                        <list-item>
                          <p>If <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
                    is even: <inline-formula><alternatives><tex-math><![CDATA[y = L^T y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                        </list-item>
                        <list-item>
                          <p>If <inline-formula><alternatives><tex-math><![CDATA[j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
                    is odd: <inline-formula><alternatives><tex-math><![CDATA[y = L y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                        </list-item>
                      </list>
                    </list-item>
                    <list-item>
                      <label>iii)</label>
                      <p>Compute quadratic form <inline-formula><alternatives><tex-math><![CDATA[q = y^Ty]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                    </list-item>
                  </list>
                </list-item>
                <list-item>
                  <p>Compute log-density: <inline-formula><alternatives><tex-math><![CDATA[\log p(x) = -\frac{1}{2}(d\log(2\pi) + \log|Q^{\nu+1}| + q)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>âˆ’</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>d</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mi>Ï€</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
              </list>
            </sec>
          </sec>
          <sec id="scaled-precision-matrix-nb-article">
            <title>Scaled Precision Matrix</title>
            <sec id="precision-matrix-construction-1-nb-article">
              <title>Precision Matrix Construction</title>
              <p>We start by constructing the precision matrix
        <inline-formula><alternatives><tex-math><![CDATA[Q]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
        for a 2D MatÃ©rn field on a grid of size
        <inline-formula><alternatives><tex-math><![CDATA[d_x \times d_y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>Ã—</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:</p>
              <p>
                <disp-formula>
                  <alternatives>
                    <tex-math><![CDATA[
        Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2 
        ]]></tex-math>
                    <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                      <mml:mrow>
                        <mml:mi>Q</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mi>Q</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>I</mml:mi>
                          <mml:msub>
                            <mml:mi>d</mml:mi>
                            <mml:mi>y</mml:mi>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>I</mml:mi>
                          <mml:msub>
                            <mml:mi>d</mml:mi>
                            <mml:mi>x</mml:mi>
                          </mml:msub>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>Q</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:math>
                  </alternatives>
                </disp-formula>
              </p>
              <p>where <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
        denotes the Kronecker product, <inline-formula><alternatives><tex-math><![CDATA[Q_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
        are 1D precision matrices for the x and y dimensions
        respectively (typically AR(1)-like structures), and
        <inline-formula><alternatives><tex-math><![CDATA[I_{d_x}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives><tex-math><![CDATA[I_{d_y}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula>
        are identity matrices of appropriate sizes. We will then have to
        work with the matrix <inline-formula><alternatives><tex-math><![CDATA[Q^{\nu + 1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>.</p>
              <p>To ensure unit marginal variances, we need to scale this
        precision matrix. Let <inline-formula><alternatives><tex-math><![CDATA[D]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>
        be a diagonal matrix where <inline-formula><alternatives><tex-math><![CDATA[D_{ii} = \sqrt{\Sigma_{ii}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mi>Î£</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>,
        and <inline-formula><alternatives><tex-math><![CDATA[\Sigma = (Q^{\nu+1})^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î£</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.
        The scaled precision matrix is then:
        <disp-formula><alternatives><tex-math><![CDATA[
        \tilde{Q} = DQ^{\nu+1}D
        ]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block"><mml:mrow><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
            </sec>
            <sec id="efficient-computation-of-scaling-matrix-d-nb-article">
              <title>Efficient Computation of Scaling Matrix D</title>
              <list list-type="order">
                <list-item>
                  <p>Compute the Cholesky decomposition of the original
            <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Compute <inline-formula><alternatives><tex-math><![CDATA[R = L^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>,
            so that <inline-formula><alternatives><tex-math><![CDATA[S = Q^{-1} = R^TR]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
                </list-item>
                <list-item>
                  <p>We then calculate the entries in
            <inline-formula><alternatives><tex-math><![CDATA[D]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>
            using the following steps:</p>
                  <list list-type="roman-lower">
                    <list-item>
                      <p>For <inline-formula><alternatives><tex-math><![CDATA[\nu = 0]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
                <inline-formula><alternatives><tex-math><![CDATA[D_{ii} = \sqrt{\Sigma_{ii}} = \sqrt{\sum_j (R_{ji})^2}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mi>Î£</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msqrt><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>,
                the column-wise norm of <inline-formula><alternatives><tex-math><![CDATA[R]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula>.</p>
                    </list-item>
                    <list-item>
                      <p>For <inline-formula><alternatives><tex-math><![CDATA[\nu = 1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
                we use the column-wise norm of
                <inline-formula><alternatives><tex-math><![CDATA[R^TR]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                    </list-item>
                    <list-item>
                      <p>For <inline-formula><alternatives><tex-math><![CDATA[\nu = 2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
                we use the column-wise norm of
                <inline-formula><alternatives><tex-math><![CDATA[RR^TR]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>R</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                    </list-item>
                  </list>
                </list-item>
              </list>
            </sec>
            <sec id="log-determinant-nb-article">
              <title>Log determinant</title>
              <list list-type="order">
                <list-item>
                  <p>First, note that <inline-formula><alternatives><tex-math><![CDATA[\log|\tilde{Q}| = \log|DQ^{\nu+1}D| = 2\log|D| + \log|Q^{\nu+1}|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>We can compute <inline-formula><alternatives><tex-math><![CDATA[\log|D|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
            directly from the diagonal elements of D,
            i.e.Â <inline-formula><alternatives><tex-math><![CDATA[\log|D| = \sum_i \log(D_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>For <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
            we can use the properties of the Cholesky decomposition:
            <inline-formula><alternatives><tex-math><![CDATA[\log|Q^{\nu+1}| = (\nu+1)\log|Q| = (\nu+1)\log|LL^T| = 2(\nu+1)\sum_i \log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Combining these, we get <inline-formula><alternatives><tex-math><![CDATA[\log|\tilde{Q}| = 2\sum_i \log(D_{ii}) + 2(\nu+1)\sum_i \log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
              </list>
            </sec>
            <sec id="quadratic-form-nb-article">
              <title>Quadratic Form</title>
              <list list-type="order">
                <list-item>
                  <p>First, note that <inline-formula><alternatives><tex-math><![CDATA[z^T\tilde{Q}z = z^TDQ^{\nu+1}Dz = (Dz)^TQ^{\nu+1}(Dz)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>D</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>D</mml:mi><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Let <inline-formula><alternatives><tex-math><![CDATA[y = Dz]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
            We can compute this element-wise as
            <inline-formula><alternatives><tex-math><![CDATA[y_i = D_{ii}z_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Now we compute <inline-formula><alternatives><tex-math><![CDATA[y^TQ^{\nu+1}y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
            as in the unscaled case.</p>
                </list-item>
              </list>
            </sec>
            <sec id="algorithm-1-nb-article">
              <title>Algorithm</title>
              <p>Putting it all together, hereâ€™s the algorithm for computing
        the log-density of the Gaussian copula using the scaled
        precision matrix:</p>
              <list list-type="order">
                <list-item>
                  <p>Construct <inline-formula><alternatives><tex-math><![CDATA[Q = Q_1 \otimes I_{d_y} + I_{d_x} \otimes Q_2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Compute Cholesky decomposition
            <inline-formula><alternatives><tex-math><![CDATA[Q = LL^T]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>Compute <inline-formula><alternatives><tex-math><![CDATA[R = L^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
            and use it to compute D as described earlier</p>
                </list-item>
                <list-item>
                  <p>Compute log-determinant: <inline-formula><alternatives><tex-math><![CDATA[\log|\tilde{Q}| = 2\sum_i \log(D_{ii}) + 2(\nu+1)\sum_i \log(L_{ii})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
                <list-item>
                  <p>For each observation <inline-formula><alternatives><tex-math><![CDATA[z = \Phi^{-1}(u)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>:</p>
                  <list list-type="roman-lower">
                    <list-item>
                      <label>i)</label>
                      <p>Compute <inline-formula><alternatives><tex-math><![CDATA[y = Dz]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
                    </list-item>
                    <list-item>
                      <label>ii)</label>
                      <p>Compute <inline-formula><alternatives><tex-math><![CDATA[y^TQ^{\nu+1}y]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>Î½</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
                as in the unscaled case.</p>
                    </list-item>
                  </list>
                </list-item>
                <list-item>
                  <p>Compute log-density: <inline-formula><alternatives><tex-math><![CDATA[\log c(u) = -\frac{1}{2}(d\log(2\pi) + \log|\tilde{Q}| + q - z^Tz)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>âˆ’</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>d</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mi>Ï€</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mover><mml:mi>Q</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mo>âˆ’</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
                </list-item>
              </list>
            </sec>
          </sec>
        </sec>
      </sec>
    </body>
    <back>
</back>
  </sub-article>
</article>
