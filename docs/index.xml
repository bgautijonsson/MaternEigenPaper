<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
  <front>
    <article-meta>
      <title-group>
        <article-title>Bridging Gaussian Markov Random Fields and Copulas: A
Fast Algorithm for Efficient Gaussian Copula Density Computation with
MatÃ©rn-like Precision Matrices</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>JÃ³nsson</surname>
            <given-names>BrynjÃ³lfur Gauti GuÃ°rÃºnar</given-names>
          </name>
          <string-name>BrynjÃ³lfur Gauti GuÃ°rÃºnar JÃ³nsson</string-name>
          <email>brynjolfur@hi.is</email>
          <xref ref-type="aff" rid="aff-1">a</xref>
        </contrib>
      </contrib-group>
      <aff id="aff-1">
        <institution-wrap>
          <institution>University of Iceland</institution>
        </institution-wrap>
      </aff>
      <history/>
      <abstract>
Gaussian Markov Random Fields (GMRFs) have long been a powerful tool for
modeling spatial and temporal dependencies in various fields. Similarly,
copulas have proven invaluable for modeling complex dependency
structures in multivariate data. However, the combination of these two
approaches - using GMRFs within copula models - has historically been
computationally inefficient, limiting their joint application to smaller
datasets or simpler models. This work presents a novel algorithm that
overcomes these limitations, allowing for fast and efficient computation
of Gaussian Copula densities using GMRF precision structures. By
bridging the gap between GMRFs and copulas, this method opens up new
possibilities for analyzing large-scale, high-dimensional spatial and
spatio-temporal data with complex dependency structures.
</abstract>
    </article-meta>
  </front>
  <body>
    <sec id="introduction">
      <title>Introduction</title>
      <sec id="review">
        <title>Review</title>
        <p>Gaussian Markov Random Fields (GMRFs) and copulas are two
    powerful statistical tools, each offering unique strengths in
    modeling complex data structures. GMRFs excel in capturing spatial
    and temporal dependencies, particularly in fields such as
    environmental science, epidemiology, and image analysis. Their
    ability to represent local dependencies through sparse precision
    matrices makes them computationally attractive for high-dimensional
    problems. Copulas, on the other hand, provide a flexible framework
    for modeling multivariate dependencies, allowing separate
    specification of marginal distributions and their joint
    behavior.</p>
        <p>The Gaussian copula, in particular, has gained popularity due to
    its interpretability and connection to the multivariate normal
    distribution. However, combining GMRFs with copulas has historically
    been computationally challenging, limiting their joint application
    to smaller datasets or simpler models.</p>
        <p>Let <inline-formula><alternatives><tex-math><![CDATA[\mathbf{X} = (X_1, X_2, \ldots, X_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ—</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    be a multivariate random vector with marginal distribution functions
    <inline-formula><alternatives><tex-math><![CDATA[F_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    for <inline-formula><alternatives><tex-math><![CDATA[i = 1, 2, \ldots, n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
    The joint distribution function of <inline-formula><alternatives><tex-math><![CDATA[\mathbf{X}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ—</mml:mi></mml:math></alternatives></inline-formula>
    can be written as:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    F_{\mathbf{X}}(\mathbf{x}) = C(F_1(x_1), F_2(x_2), \ldots, F_n(x_n)),
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>F</mml:mi>
                    <mml:mi>ğ—</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>ğ±</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mi>C</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:msub>
                      <mml:mi>F</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>F</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mi>â€¦</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>F</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is the Gaussian copula defined by the GMRF precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>.
    The Gaussian copula <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is given by:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    C(u_1, u_2, \ldots, u_n) = \Phi_\mathbf{Q}(\Phi^{-1}(u_1), \Phi^{-1}(u_2), \ldots, \Phi^{-1}(u_n)),
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:msub>
                      <mml:mi>u</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>u</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mi>â€¦</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>u</mml:mi>
                      <mml:mi>n</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>Î¦</mml:mi>
                    <mml:mi>ğ</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:msup>
                      <mml:mi>Î¦</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>Î¦</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>,</mml:mo>
                    <mml:mi>â€¦</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>Î¦</mml:mi>
                      <mml:mrow>
                        <mml:mi>âˆ’</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\Phi_\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Î¦</mml:mi><mml:mi>ğ</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the joint cumulative distribution function of a multivariate
    normal distribution with mean vector <inline-formula><alternatives><tex-math><![CDATA[\mathbf{0}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mn>ğŸ</mml:mn></mml:math></alternatives></inline-formula>
    and precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    and <inline-formula><alternatives><tex-math><![CDATA[\Phi^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    is the inverse of the standard normal cumulative distribution
    function.</p>
        <p>A critical requirement for the precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    governing the GMRF copula <inline-formula><alternatives><tex-math><![CDATA[C]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
    is that <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma} = \mathbf{Q}^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
    should have a unit diagonal, i.e.Â the marginal variance is equal to
    one everywhere.. This ensures it operates on the same scale as the
    transformed data, <inline-formula><alternatives><tex-math><![CDATA[\Phi^{-1}(u_i)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
    However, this can be challenging as GMRFs are typically defined in
    terms of precision matrices that often imply non-unit marginal
    variances.</p>
        <p>This paper presents a novel algorithm that bridges the gap
    between GMRFs and copulas, allowing for fast and efficient
    computation of Gaussian copula densities using GMRF precision
    structures. Our method focuses on creating a MatÃ©rn-like precision
    matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    with unit marginal variance and efficiently computing the
    multivariate Gaussian copula density of
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Z} = \Phi^{-1}(\mathbf{u})]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ™</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    where <inline-formula><alternatives><tex-math><![CDATA[u_i \sim \text{Uniform}(0, 1)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">Uniform</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[i = 1, \dots, n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        <p>The key innovation lies in leveraging the special structure of
    the precision matrix:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \mathbf{Q} = \mathbf{Q}_1 \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{Q}_1,
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>ğ</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>ğ</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>âŠ—</mml:mo>
                  <mml:mi>ğˆ</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mi>ğˆ</mml:mi>
                  <mml:mo>âŠ—</mml:mo>
                  <mml:msub>
                    <mml:mi>ğ</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    is the precision matrix of a standardized one-dimensional AR(1)
    process and <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
    denotes the Kronecker product. By employing efficient
    eigendecomposition techniques, our method avoids explicit formation
    and inversion of the large precision matrix
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>,
    making it particularly suitable for high-dimensional spatial data.
    In additions to the exact method, we mention approximations to
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    using circuland and folded circulant matrices.</p>
      </sec>
      <sec id="problem-formulation">
        <title>Problem Formulation</title>
        <p>Consider a spatial field on a regular
    <inline-formula><alternatives><tex-math><![CDATA[n \times n]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>n</mml:mi><mml:mo>Ã—</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    grid. Our objective is to compute the Gaussian copula density
    efficiently for this field. This computation involves:</p>
        <list list-type="order">
          <list-item>
            <p>Specifying a precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
        that represents the spatial dependence structure.</p>
          </list-item>
          <list-item>
            <p>Ensuring the implied covariance matrix
        <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma} = \mathbf{Q}^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
        has unit diagonal elements.</p>
          </list-item>
          <list-item>
            <p>Computing the density for large spatial fields in a
        computationally efficient manner.</p>
          </list-item>
        </list>
        <sec id="precision-matrix-structure">
          <title>Precision Matrix Structure</title>
          <p>We use a MatÃ©rn-like precision matrix structure defined as:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \begin{aligned}
      \mathbf{Q} &= \mathbf{\tilde{Q}^\nu}, \quad\nu \in \{0, 1, 2\}  \\
      \mathbf{\tilde Q} &= \mathbf{Q}_1 \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{Q}_1,
      \end{aligned}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right">
                        <mml:mi>ğ</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:msup>
                          <mml:mover>
                            <mml:mi>ğ</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                          <mml:mi>ğ›</mml:mi>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="1.0em"/>
                        <mml:mi>Î½</mml:mi>
                        <mml:mo>âˆˆ</mml:mo>
                        <mml:mo stretchy="false" form="prefix">{</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false" form="postfix">}</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right">
                        <mml:mover>
                          <mml:mi>ğ</mml:mi>
                          <mml:mo accent="true">Ìƒ</mml:mo>
                        </mml:mover>
                      </mml:mtd>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:msub>
                          <mml:mi>ğ</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
      is the precision matrix of a standardized one-dimensional AR(1)
      process, and <inline-formula><alternatives><tex-math><![CDATA[\otimes]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>âŠ—</mml:mi></mml:math></alternatives></inline-formula>
      denotes the Kronecker product.</p>
        </sec>
        <sec id="eigendecomposition-method">
          <title>Eigendecomposition Method</title>
          <p>The properties of Kronecker products and sums are utilized to
      compute the eigendecomposition of <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>.
      This approach facilitates:</p>
          <list list-type="order">
            <list-item>
              <p>Calculation of <inline-formula><alternatives><tex-math><![CDATA[\log |\mathbf{Q}|]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>ğ</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
            </list-item>
            <list-item>
              <p>Computation of quadratic forms
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{x}^T\mathbf{Q}\mathbf{x}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ±</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ</mml:mi><mml:mi>ğ±</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p>
            </list-item>
            <list-item>
              <p>Determination of the diagonal elements of
          <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma} = \mathbf{Q}^{-1}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>ğ</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
          without explicit matrix inversion.</p>
            </list-item>
          </list>
        </sec>
        <sec id="unit-marginal-variance-adjustment">
          <title>Unit Marginal Variance Adjustment</title>
          <p>To ensure unit marginal variances, which is necessary for
      copula applications, we employ a scaling method for the precision
      matrix.</p>
        </sec>
        <sec id="approximation-methods">
          <title>Approximation Methods</title>
          <p>We introduce circulant and folded circulant approximations to
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>.
      These approximations offer potential computational advantages,
      which we analyze in terms of efficiency and accuracy
      trade-offs.</p>
        </sec>
      </sec>
    </sec>
    <sec id="methods">
      <title>Methods</title>
      <sec id="gaussian-copula-density-computation">
        <title>Gaussian Copula Density Computation</title>
        <p>The Gaussian copula density for a random vector
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{U} = (U_1, ..., U_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ”</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    with <inline-formula><alternatives><tex-math><![CDATA[U_i \sim \text{Uniform}(0,1)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">Uniform</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is given by:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    c(\mathbf{u}) = |\mathbf{Q}|^{1/2} \exp\left(-\frac{1}{2}\mathbf{z}^T(\mathbf{Q} - \mathbf{I})\mathbf{z}\right)
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>ğ®</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">|</mml:mo>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo stretchy="true" form="postfix">|</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mi>/</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>exp</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>âˆ’</mml:mi>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mi>ğ³</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>ğ</mml:mi>
                      <mml:mo>âˆ’</mml:mo>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z} = (z_1, ..., z_n)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    with <inline-formula><alternatives><tex-math><![CDATA[z_i = \Phi^{-1}(u_i)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>Î¦</mml:mi><mml:mrow><mml:mi>âˆ’</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    is the precision matrix, and <inline-formula><alternatives><tex-math><![CDATA[\mathbf{I}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğˆ</mml:mi></mml:math></alternatives></inline-formula>
    is the identity matrix.</p>
        <p>The log-density can be expressed as:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \log c(\mathbf{u}) = \frac{1}{2}\log|\mathbf{Q}| - \frac{1}{2}\mathbf{z}^T\mathbf{Q}\mathbf{z} + \frac{1}{2}\mathbf{z}^T\mathbf{z}
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mo>log</mml:mo>
                  <mml:mi>c</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">(</mml:mo>
                    <mml:mi>ğ®</mml:mi>
                    <mml:mo stretchy="true" form="postfix">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:mo>log</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="true" form="prefix">|</mml:mo>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo stretchy="true" form="postfix">|</mml:mo>
                  </mml:mrow>
                  <mml:mo>âˆ’</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:msup>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                  <mml:mi>ğ</mml:mi>
                  <mml:mi>ğ³</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mn>2</mml:mn>
                  </mml:mfrac>
                  <mml:msup>
                    <mml:mi>ğ³</mml:mi>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                  <mml:mi>ğ³</mml:mi>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>Our goal is to efficiently compute this log-density for large
    spatial fields.</p>
      </sec>
      <sec id="precision-matrix-structure-1">
        <title>Precision Matrix Structure</title>
        <p>We define the precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
    as:</p>
        <p>
          <disp-formula>
            <alternatives>
              <tex-math><![CDATA[
    \mathbf{Q} = (\mathbf{Q}_1 \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{Q}_1)^\nu, \quad \nu \in \{0, 1, 2\}
    ]]></tex-math>
              <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                <mml:mrow>
                  <mml:mi>ğ</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>ğˆ</mml:mi>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:msub>
                        <mml:mi>ğ</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>Î½</mml:mi>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="1.0em"/>
                  <mml:mi>Î½</mml:mi>
                  <mml:mo>âˆˆ</mml:mo>
                  <mml:mo stretchy="false" form="prefix">{</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false" form="postfix">}</mml:mo>
                </mml:mrow>
              </mml:math>
            </alternatives>
          </disp-formula>
        </p>
        <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    is the precision matrix of a one-dimensional AR(1) process. This
    matrix is then scaled so that it implied unit marginal
    variances.</p>
      </sec>
      <sec id="computation-process">
        <title>Computation Process</title>
        <sec id="step-1-eigendecomposition-of-mathbfq_1">
          <title>Step 1: Eigendecomposition of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula></title>
          <p>We first compute the eigendecomposition of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q}_1 = \mathbf{V}\mathbf{\Lambda}\mathbf{V}^T
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ğ</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo>=</mml:mo>
                    <mml:mi>ğ•</mml:mi>
                    <mml:mi>ğš²</mml:mi>
                    <mml:msup>
                      <mml:mi>ğ•</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{V}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ•</mml:mi></mml:math></alternatives></inline-formula>
      is the matrix of eigenvectors and <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Lambda}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğš²</mml:mi></mml:math></alternatives></inline-formula>
      is the diagonal matrix of eigenvalues. Then, the
      eigendecomposition of <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      is:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{Q} = (\mathbf{V} \otimes \mathbf{V})(\mathbf{\Lambda} \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{\Lambda})^\nu(\mathbf{V} \otimes \mathbf{V})^T.
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:mo stretchy="true" form="prefix">(</mml:mo>
                      <mml:mi>ğ•</mml:mi>
                      <mml:mo>âŠ—</mml:mo>
                      <mml:mi>ğ•</mml:mi>
                      <mml:mo stretchy="true" form="postfix">)</mml:mo>
                    </mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>ğš²</mml:mi>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ğˆ</mml:mi>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:mi>ğš²</mml:mi>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>Î½</mml:mi>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">(</mml:mo>
                        <mml:mi>ğ•</mml:mi>
                        <mml:mo>âŠ—</mml:mo>
                        <mml:mi>ğ•</mml:mi>
                        <mml:mo stretchy="true" form="postfix">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi>.</mml:mi>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>This means that the eigenvectors of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      are <inline-formula><alternatives><tex-math><![CDATA[\mathbf{v}_j \otimes \mathbf{v}_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>ğ¯</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mi>ğ¯</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      and the corresponding eigenvalues are
      <inline-formula><alternatives><tex-math><![CDATA[\lambda_i + \lambda_j]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>Î»</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Î»</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </sec>
        <sec id="step-2-computation-of-marginal-standard-deviations">
          <title>Step 2: Computation of Marginal Standard Deviations</title>
          <p>Using the eigendecomposition of <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>,
      we compute the marginal standard deviations and store them in a
      vector <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\sigma}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ›”</mml:mi></mml:math></alternatives></inline-formula>,
      i.e.Â <inline-formula><alternatives><tex-math><![CDATA[\sigma_i = \sqrt{\Sigma_{ii}}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mi>Î£</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \mathbf{\sigma} = \sqrt{\sum_{i,j} \frac{(\mathbf{v}_j \otimes \mathbf{v}_i)^2}{(\lambda_i + \lambda_j)^\nu}}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mrow>
                    <mml:mi>ğ›”</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>âˆ‘</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:munder>
                        <mml:mfrac>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>ğ¯</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:msub>
                              <mml:mo>âŠ—</mml:mo>
                              <mml:msub>
                                <mml:mi>ğ¯</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="true" form="prefix">(</mml:mo>
                              <mml:msub>
                                <mml:mi>Î»</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                              <mml:mo>+</mml:mo>
                              <mml:msub>
                                <mml:mi>Î»</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:msub>
                              <mml:mo stretchy="true" form="postfix">)</mml:mo>
                            </mml:mrow>
                            <mml:mi>Î½</mml:mi>
                          </mml:msup>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:msqrt>
                  </mml:mrow>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{v}_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ¯</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      are the eigenvectors and <inline-formula><alternatives><tex-math><![CDATA[\lambda_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>Î»</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      are the eigenvalues of <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}_1]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:msub><mml:mi>ğ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>.</p>
        </sec>
        <sec id="step-3-scaling-the-eigendecomposition">
          <title>Step 3: Scaling the Eigendecomposition</title>
          <p>We scale the eigendecomposition of
      <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      using the marginal standard deviations:</p>
          <p>
            <disp-formula>
              <alternatives>
                <tex-math><![CDATA[
      \begin{aligned}
      \mathbf{D}\mathbf{Q}\mathbf{D} &= \mathbf{D}(\mathbf{V} \otimes \mathbf{V})(\mathbf{\Lambda} \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{\Lambda})^\nu(\mathbf{V} \otimes \mathbf{V})^T\mathbf{D} \\
      &= (\mathbf{\tilde V} \otimes \mathbf{\tilde V})(\mathbf{\tilde\Lambda} \otimes \mathbf{I} + \mathbf{I} \otimes \mathbf{\tilde \Lambda})^\nu(\mathbf{\tilde V} \otimes \mathbf{\tilde V})^T
      \end{aligned}
      ]]></tex-math>
                <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="block">
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right">
                        <mml:mi>ğƒ</mml:mi>
                        <mml:mi>ğ</mml:mi>
                        <mml:mi>ğƒ</mml:mi>
                      </mml:mtd>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:mi>ğƒ</mml:mi>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mi>ğ•</mml:mi>
                          <mml:mo>âŠ—</mml:mo>
                          <mml:mi>ğ•</mml:mi>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mi>ğš²</mml:mi>
                            <mml:mo>âŠ—</mml:mo>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:mo>âŠ—</mml:mo>
                            <mml:mi>ğš²</mml:mi>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                          <mml:mi>Î½</mml:mi>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mi>ğ•</mml:mi>
                            <mml:mo>âŠ—</mml:mo>
                            <mml:mi>ğ•</mml:mi>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                        <mml:mi>ğƒ</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="right" style="text-align: right"/>
                      <mml:mtd columnalign="left" style="text-align: left">
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">(</mml:mo>
                          <mml:mover>
                            <mml:mi>ğ•</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                          <mml:mo>âŠ—</mml:mo>
                          <mml:mover>
                            <mml:mi>ğ•</mml:mi>
                            <mml:mo accent="true">Ìƒ</mml:mo>
                          </mml:mover>
                          <mml:mo stretchy="true" form="postfix">)</mml:mo>
                        </mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mover>
                              <mml:mi>ğš²</mml:mi>
                              <mml:mo accent="true">Ìƒ</mml:mo>
                            </mml:mover>
                            <mml:mo>âŠ—</mml:mo>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mi>ğˆ</mml:mi>
                            <mml:mo>âŠ—</mml:mo>
                            <mml:mover>
                              <mml:mi>ğš²</mml:mi>
                              <mml:mo accent="true">Ìƒ</mml:mo>
                            </mml:mover>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                          <mml:mi>Î½</mml:mi>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="true" form="prefix">(</mml:mo>
                            <mml:mover>
                              <mml:mi>ğ•</mml:mi>
                              <mml:mo accent="true">Ìƒ</mml:mo>
                            </mml:mover>
                            <mml:mo>âŠ—</mml:mo>
                            <mml:mover>
                              <mml:mi>ğ•</mml:mi>
                              <mml:mo accent="true">Ìƒ</mml:mo>
                            </mml:mover>
                            <mml:mo stretchy="true" form="postfix">)</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:math>
              </alternatives>
            </disp-formula>
          </p>
          <p>where <inline-formula><alternatives><tex-math><![CDATA[\mathbf{D}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğƒ</mml:mi></mml:math></alternatives></inline-formula>
      is a diagonal matrix with <inline-formula><alternatives><tex-math><![CDATA[D_{ii} = \sigma_i]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Ïƒ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </sec>
        <sec id="step-4-efficient-computation-of-log-density">
          <title>Step 4: Efficient Computation of Log-Density</title>
          <p>Using this scaled eigendecomposition, we efficiently
      compute:</p>
          <list list-type="order">
            <list-item>
              <p>Log-determinant: <inline-formula><alternatives><tex-math><![CDATA[\log|\mathbf{D}\mathbf{Q}\mathbf{D}| = \sum_{i,j} \nu \log(\tilde\lambda_i + \tilde\lambda_j)]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>ğƒ</mml:mi><mml:mi>ğ</mml:mi><mml:mi>ğƒ</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>Î½</mml:mi><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
            <list-item>
              <p>Quadratic form: <inline-formula><alternatives><tex-math><![CDATA[\mathbf{z}^T\mathbf{D}\mathbf{Q}\mathbf{D}\mathbf{z} = \sum_{i,j} (\tilde\lambda_i + \tilde\lambda_j)^\nu y_{ij}^2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>ğ³</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>ğƒ</mml:mi><mml:mi>ğ</mml:mi><mml:mi>ğƒ</mml:mi><mml:mi>ğ³</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover><mml:mi>Î»</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>Î½</mml:mi></mml:msup><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>,
          where <inline-formula><alternatives><tex-math><![CDATA[y_{ij} = (\mathbf{\tilde v}_j \otimes \mathbf{\tilde v}_i)^T\mathbf{z}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mover><mml:mi>ğ¯</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>âŠ—</mml:mo><mml:msub><mml:mover><mml:mi>ğ¯</mml:mi><mml:mo accent="true">Ìƒ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>ğ³</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></p>
            </list-item>
          </list>
          <p>This approach allows for efficient computation of the Gaussian
      copula density without explicitly forming the full
      <inline-formula><alternatives><tex-math><![CDATA[n^2 \times n^2]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>Ã—</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
      precision matrix <inline-formula><alternatives><tex-math><![CDATA[\mathbf{Q}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      or its inverse <inline-formula><alternatives><tex-math><![CDATA[\mathbf{\Sigma}]]></tex-math><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" display="inline"><mml:mi>ğšº</mml:mi></mml:math></alternatives></inline-formula>.</p>
        </sec>
      </sec>
    </sec>
  </body>
  <back>
</back>
</article>
